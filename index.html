<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Optimizador Supernova (Horizonte de Sucesos) para Windows</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Fira+Code&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background: #000000 url('https://www.transparenttextures.com/patterns/stardust.png');
        }
        .code-block {
            background-color: rgba(17, 24, 39, 0.8); /* bg-gray-900 with opacity */
            backdrop-filter: blur(10px);
            color: #e5e7eb; /* gray-200 */
            border: 1px solid #b91c1c; /* red-700 */
            border-radius: 0.5rem;
            padding: 1.25rem;
            position: relative;
            font-family: 'Fira
            Code', monospace;
            white-space: pre-wrap;
            word-wrap: break-word;
            font-size: 0.9rem;
            line-height: 1.6;
        }
        .copy-button {
            position: absolute;
            top: 0.75rem;
            right: 0.75rem;
            background-color: #7f1d1d; /* red-800 */
            color: #fecaca; /* red-200 */
            border: 1px solid #991b1b; /* red-700 */
            padding: 0.5rem 0.75rem;
            border-radius: 0.375rem;
            cursor: pointer;
            transition: all 0.2s ease-in-out;
            font-weight: 600;
        }
        .copy-button:hover {
            background-color: #991b1b;
            color: #ffffff;
        }
        .feature-card {
            background: linear-gradient(145deg, rgba(31, 41, 55, 0.5), rgba(17, 24, 39, 0.5));
            backdrop-filter: blur(10px);
            border-radius: 0.75rem;
            padding: 1.5rem;
            border: 1px solid #991b1b;
            transition: transform 0.3s ease, box-shadow 0.3s ease;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.2);
        }
        .feature-card:hover {
            transform: translateY(-8px);
            box-shadow: 0 10px 20px rgba(220, 38, 38, 0.2);
        }
        .glow-text {
            text-shadow: 0 0 15px rgba(248, 113, 113, 0.8);
        }
    </style>
</head>
<body class="text-slate-300">

    <div class="container mx-auto max-w-5xl p-4 sm:p-6 lg:p-8">
        <header class="text-center mb-12">
            <h1 class="text-4xl md:text-5xl font-bold text-white mb-4 glow-text">Optimizador Supernova</h1>
            <p class="text-xl text-red-300">Horizonte de Sucesos: El punto de no retorno hacia el rendimiento absoluto.</p>
        </header>

        <main>
            <div class="grid md:grid-cols-2 lg:grid-cols-3 gap-6 mb-12">
                <div class="feature-card">
                    <h3 class="text-xl font-bold text-red-400 mb-2">UI Instantánea</h3>
                    <p class="text-slate-400">Ajustes de registro a nivel de milisegundo para que los menús y ventanas respondan antes de que termines de hacer clic.</p>
                </div>
                <div class="feature-card">
                    <h3 class="text-xl font-bold text-red-400 mb-2">Tuning Interactivo</h3>
                    <p class="text-slate-400">Tú decides qué servicios desactivar (impresora, Bluetooth, etc.) para una optimización a medida y 100% segura.</p>
                </div>
                 <div class="feature-card">
                    <h3 class="text-xl font-bold text-red-400 mb-2">Limpieza Profunda</h3>
                    <p class="text-slate-400">Purga los registros de eventos del sistema, cachés de shaders y te permite eliminar puntos de restauración antiguos.</p>
                </div>
            </div>

            <!-- INSTRUCCIONES DE USO -->
            <div class="bg-gray-900/50 backdrop-blur-sm border border-red-800 p-6 rounded-lg mb-8">
                <h2 class="text-2xl font-semibold text-white mb-4">Instrucciones para la Singularidad</h2>
                <ol class="list-decimal list-inside space-y-3 text-slate-300">
                    <li>Haz clic en el botón <strong>"Copiar Script Supernova"</strong>.</li>
                    <li>Abre el menú Inicio, escribe <strong>"PowerShell"</strong>, haz clic derecho y selecciona <strong>"Ejecutar como administrador"</strong>.</li>
                    <li>En la ventana azul, haz clic derecho para pegar el script y presiona <strong>Enter</strong>.</li>
                    <li class="text-yellow-400"><strong class="text-yellow-200">¡Atención!</strong> Responde a las preguntas (S/N) que el script te hará para personalizar la optimización.</li>
                    <li>Presencia la explosión de rendimiento en tu sistema.</li>
                </ol>
            </div>

            <!-- BLOQUE DEL SCRIPT -->
            <div>
                <h2 class="text-3xl font-bold text-white mb-4 text-center">Script de Optimización Supernova</h2>
                <div class="code-block">
                    <button id="copyButton" class="copy-button">Copiar Script Supernova</button>
                    <pre><code id="powerShellScript">
# =================================================================================
# ||                 SCRIPT DE OPTIMIZACIÓN SUPERNOVA PARA WINDOWS                 ||
# ||          Ajustes de Registro | Tuning Interactivo | Limpieza Absoluta        ||
# ||                         VERSIÓN HORIZONTE DE SUCESOS                          ||
# =================================================================================

Function Show-Intro {
    Clear-Host
    Write-Host "=======================================================" -ForegroundColor 'DarkRed'
    Write-Host "     INICIANDO SCRIPT DE OPTIMIZACIÓN SUPERNOVA" -ForegroundColor 'DarkRed'
    Write-Host "              (Horizonte de Sucesos)" -ForegroundColor 'Yellow'
    Write-Host "=======================================================" -ForegroundColor Gray
    Write-Host "ADVERTENCIA: Estás ejecutando el script más completo y potente." -ForegroundColor Red
    Write-Host "Se te harán preguntas para adaptar la optimización a TU sistema." -ForegroundColor Yellow
    Write-Host "Lee cada pregunta con atención. Los cambios son directos y profundos." -ForegroundColor Red
    Write-Host "======================================================="
    Start-Sleep -Seconds 10
}

# --- PASO 1: LIMPIEZA SUPERNOVA (INCLUYE LOGS Y OPCIÓN DE RESTORE POINTS) ---
Function Step1-Supernova-Cleanup {
    Write-Host "`n[PASO 1 de 10] - Iniciando Limpieza Supernova..." -ForegroundColor Green
    # ... Limpieza estándar ...
    $Locations = @(
        "$env:windir\Temp\*", "$env:TEMP\*", "$env:windir\SoftwareDistribution\Download\*", "$env:windir\Prefetch\*",
        "$env:ProgramData\Microsoft\Windows\WER\ReportQueue\*", "$env:LOCALAPPDATA\NVIDIA\GLCache\*",
        "$env:LOCALAPPDATA\AMD\DxCache\*", "$env:LOCALAPPDATA\Intel\ShaderCache\*", "$env:LOCALAPPDATA\Microsoft\Office\16.0\WebServiceCache\*"
    )
    foreach ($loc in $Locations) { Remove-Item -Path $loc -Recurse -Force -ErrorAction SilentlyContinue }
    
    Write-Host " - Purgando Registros de Eventos de Windows..." -ForegroundColor Gray
    Get-EventLog -List | ForEach-Object { Clear-EventLog -LogName $_.Log }
    
    Write-Host " - Limpiando Almacén de Componentes (WinSxS)..." -ForegroundColor Yellow
    DISM.exe /Online /Cleanup-Image /StartComponentCleanup /Quiet
    
    $Confirmation = Read-Host "`n`n¿Deseas eliminar TODOS los Puntos de Restauración del sistema para liberar espacio? (Esta acción es IRREVERSIBLE) [s/n]"
    if ($Confirmation -eq 's') {
        Write-Host " - Eliminando puntos de restauración..." -ForegroundColor Red
        try { vssadmin delete shadows /all /quiet } catch { Write-Host "   No se pudieron eliminar." -ForegroundColor Yellow }
    }
    
    Clear-RecycleBin -Force -ErrorAction SilentlyContinue; ipconfig /flushdns
}

# --- PASO 2: PURGA DE MEMORIA RAM (STANDBY LIST) ---
Function Step2-Memory-Purge {
    Write-Host "`n[PASO 2 de 10] - Purgando la Memoria RAM en caché (Standby List)..." -ForegroundColor Green
    try {
        $Signature = '[DllImport("ntdll.dll")] public static extern int NtSetSystemInformation(int SystemInformationClass, IntPtr SystemInformation, int SystemInformationLength);'
        $Kernel32 = Add-Type -MemberDefinition $Signature -Name 'Kernel32' -Namespace 'Win32' -PassThru
        $SystemInfo = New-Object IntPtr -ArgumentList 0
        $Kernel32::NtSetSystemInformation(80, $SystemInfo, 0) | Out-Null
        Write-Host "   Memoria en Standby liberada con éxito." -ForegroundColor White
    } catch { Write-Host "   No se pudo purgar la memoria." -ForegroundColor Yellow }
}

# --- PASO 3: MANTENIMIENTO Y REPARACIÓN INTEGRAL ---
Function Step3-System-Repair {
    Write-Host "`n[PASO 3 de 10] - Verificando y reparando la integridad del sistema..." -ForegroundColor Green
    sfc /scannow
    DISM /Online /Cleanup-Image /RestoreHealth
}

# --- PASO 4: ACTUALIZADOR UNIVERSAL+ ---
Function Step4-Update-Everything {
    Write-Host "`n[PASO 4 de 10] - Iniciando Actualizador Universal+..." -ForegroundColor Green
    Write-Host " - Buscando actualizaciones de Windows..."
    try { UsoClient.exe StartInteractiveScan } catch { Write-Host "   Fallo al iniciar UsoClient.exe." -ForegroundColor Yellow }
    
    Write-Host "`n - Buscando actualizaciones para programas con Winget..." -ForegroundColor White
    Read-Host "Presiona ENTER para comenzar la actualización de programas..."
    try { winget upgrade --all --accept-source-agreements --accept-package-agreements } 
    catch { Write-Host "   Winget falló o no está instalado." -ForegroundColor Red }
}

# --- PASO 5: OPTIMIZACIÓN SSD TOTAL ---
Function Step5-SSD-Optimization {
    Write-Host "`n[PASO 5 de 10] - Aplicando optimizaciones para SSD..." -ForegroundColor Green
    Optimize-Volume -DriveLetter $env:SystemDrive.Substring(0,1) -ReTrim -Verbose
    powercfg /hibernate off
    Stop-Service -Name "SysMain" -Force -ErrorAction SilentlyContinue
    Set-Service -Name "SysMain" -StartupType Disabled
}

# --- PASO 6: AJUSTES DE REGISTRO PARA UI INSTANTÁNEA ---
Function Step6-Registry-UI-Tweaks {
    Write-Host "`n[PASO 6 de 10] - Aplicando ajustes de registro para una UI instantánea..." -ForegroundColor Green
    Set-ItemProperty -Path "HKCU:\Control Panel\Desktop" -Name "MenuShowDelay" -Value "0"
    Set-ItemProperty -Path "HKCU:\Control Panel\Desktop" -Name "WaitToKillAppTimeout" -Value "2000"
    Set-ItemProperty -Path "HKCU:\Control Panel\Desktop" -Name "LowLevelHooksTimeout" -Value "1000"
    Set-ItemProperty -Path "HKCU:\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced" -Name "ExtendedUIHoverTime" -Value "50"
}

# --- PASO 7: GAMING Y RED EXTREMA ---
Function Step7-Gaming-Network-Tweaks {
    Write-Host "`n[PASO 7 de 10] - Aplicando optimizaciones para Gaming y Red..." -ForegroundColor Green
    Write-Host " - Desactivando Game Bar..."
    Set-ItemProperty -Path "HKCU:\Software\Microsoft\Windows\CurrentVersion\GameDVR" -Name "AppCaptureEnabled" -Value 0 -Force
    Write-Host " - Desactivando Network Throttling..."
    $NetPath = "HKLM:\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Multimedia\SystemProfile"
    if (-not (Test-Path $NetPath)) { New-Item -Path $NetPath -Force | Out-Null }
    Set-ItemProperty -Path $NetPath -Name "NetworkThrottlingIndex" -Value 0xffffffff -Type DWord -Force
}

# --- PASO 8: PRIVACIDAD EXTREMA ---
Function Step8-Extreme-Privacy {
    Write-Host "`n[PASO 8 de 10] - Aplicando mejoras de privacidad extrema..." -ForegroundColor Green
    Stop-Service DiagTrack; Set-Service DiagTrack -StartupType Disabled
    $TelemetryPath = "HKLM:\SOFTWARE\Policies\Microsoft\Windows\DataCollection"
    if (-not (Test-Path $TelemetryPath)) { New-Item -Path $TelemetryPath -Force | Out-Null }
    Set-ItemProperty -Path $TelemetryPath -Name "AllowTelemetry" -Value 0 -Type DWord -Force
    $Tasks = @('\Microsoft\Windows\Customer Experience Improvement Program\Consolidator', '\Microsoft\Windows\Application Experience\Microsoft Compatibility Appraiser')
    foreach($Task in $Tasks){ Get-ScheduledTask -TaskName $Task -ErrorAction SilentlyContinue | Disable-ScheduledTask }
}

# --- PASO 9: TUNING DE SERVICIOS INTERACTIVO ---
Function Step9-Interactive-Service-Tuning {
    Write-Host "`n[PASO 9 de 10] - Tuning de Servicios Interactivo..." -ForegroundColor Green
    
    Function Disable-Service($ServiceName, $DisplayName) {
        Write-Host " - Desactivando servicio '$DisplayName'..."
        Stop-Service -Name $ServiceName -Force -ErrorAction SilentlyContinue
        Set-Service -Name $ServiceName -StartupType Disabled -ErrorAction SilentlyContinue
    }
    
    if ((Read-Host "¿Usas una IMPRESORA física? [s/n]") -eq 'n') { Disable-Service 'Spooler' 'Cola de Impresión' }
    if ((Read-Host "¿Usas dispositivos BLUETOOTH? [s/n]") -eq 'n') { Disable-Service 'bthserv' 'Servicio de compatibilidad con Bluetooth' }
    if ((Read-Host "¿Usas el servicio de FAX? [s/n]") -eq 'n') { Disable-Service 'Fax' 'Fax' }
    if ((Read-Host "¿Usas ESCRITORIO REMOTO para conectarte a este equipo? [s/n]") -eq 'n') { Disable-Service 'TermService' 'Servicios de Escritorio Remoto' }
}

# --- PASO 10: DEBLOAT Y CONTROL DE INICIO ---
Function Step10-Debloat-Startup {
    Write-Host "`n[PASO 10 de 10] - Asistente de Debloat y control de inicio..." -ForegroundColor Green
    Read-Host "Presiona ENTER para abrir 'Aplicaciones de arranque' y DESHABILITA lo que no necesites..."
    Start-Process "ms-settings:startupapps"
    Read-Host "Presiona ENTER para abrir 'Desinstalar un programa' y ELIMINA lo que no uses..."
    control.exe appwiz.cpl
}

# --- FINALIZACIÓN ---
Function Finalize-Script {
    Write-Host "`n`n[PROCESO FINALIZADO] - Aplicando cambios..." -ForegroundColor Green
    Stop-Process -Name explorer -Force
    Write-Host "`n`n=======================================================" -ForegroundColor 'DarkRed'
    Write-Host "¡OPTIMIZACIÓN SUPERNOVA COMPLETADA!" -ForegroundColor 'DarkRed'
    Write-Host "El sistema ha alcanzado su máximo potencial. Un reinicio es crucial." -ForegroundColor White
    Write-Host "REINICIA TU EQUIPO AHORA para sentir la singularidad." -ForegroundColor Yellow
    Write-Host "======================================================="
}

# --- EJECUCIÓN DEL SCRIPT ---
Show-Intro
Step1-Supernova-Cleanup
Step2-Memory-Purge
Step3-System-Repair
Step4-Update-Everything
Step5-SSD-Optimization
Step6-Registry-UI-Tweaks
Step7-Gaming-Network-Tweaks
Step8-Extreme-Privacy
Step9-Interactive-Service-Tuning
Step10-Debloat-Startup
Finalize-Script

                    </code></pre>
                </div>
            </div>
        </main>
        
        <footer class="text-center text-slate-500 mt-12">
            <p>&copy; 2024. Has cruzado el horizonte de sucesos. No hay vuelta atrás.</p>
        </footer>
    </div>

    <script>
        document.getElementById('copyButton').addEventListener('click', function() {
            const scriptText = document.getElementById('powerShellScript').textContent;
            const textArea = document.createElement('textarea');
            textArea.value = scriptText;
            document.body.appendChild(textArea);
            textArea.select();
            try {
                document.execCommand('copy');
                this.textContent = '¡Copiado!';
                this.style.backgroundColor = '#10B981';
                this.style.color = '#fff';
            } catch (err) {
                this.textContent = 'Error';
                this.style.backgroundColor = '#EF4444';
                console.error('No se pudo copiar el texto: ', err);
            }
            document.body.removeChild(textArea);
            
            setTimeout(() => {
                this.textContent = 'Copiar Script Supernova';
                this.style.backgroundColor = '#7f1d1d';
                this.style.color = '#fecaca';
            }, 3000);
        });
    </script>
</body>
</html>

