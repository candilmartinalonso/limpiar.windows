<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Optimizador Titán para Windows: El Script Definitivo</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Fira+Code&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #020617; /* slate-950 */
        }
        .code-block {
            background-color: #0f172a; /* slate-900 */
            color: #e2e8f0; /* slate-200 */
            border: 1px solid #334155; /* slate-700 */
            border-radius: 0.5rem;
            padding: 1.25rem;
            position: relative;
            font-family: 'Fira Code', monospace;
            white-space: pre-wrap;
            word-wrap: break-word;
            font-size: 0.9rem;
            line-height: 1.6;
        }
        .copy-button {
            position: absolute;
            top: 0.75rem;
            right: 0.75rem;
            background-color: #1e293b; /* slate-800 */
            color: #94a3b8; /* slate-400 */
            border: 1px solid #334155; /* slate-700 */
            padding: 0.5rem 0.75rem;
            border-radius: 0.375rem;
            cursor: pointer;
            transition: all 0.2s ease-in-out;
            font-weight: 600;
        }
        .copy-button:hover {
            background-color: #334155;
            color: #e2e8f0;
        }
        .feature-card {
            background: linear-gradient(145deg, #1e293b, #0f172a);
            border-radius: 0.75rem;
            padding: 1.5rem;
            border: 1px solid #334155;
            transition: transform 0.3s ease, box-shadow 0.3s ease;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.2);
        }
        .feature-card:hover {
            transform: translateY(-8px);
            box-shadow: 0 10px 20px rgba(0, 255, 255, 0.1);
        }
        .glow-text {
            text-shadow: 0 0 8px rgba(56, 189, 248, 0.5);
        }
    </style>
</head>
<body class="text-slate-300">

    <div class="container mx-auto max-w-5xl p-4 sm:p-6 lg:p-8">
        <header class="text-center mb-12">
            <h1 class="text-4xl md:text-5xl font-bold text-white mb-4 glow-text">Optimizador Titán para Windows</h1>
            <p class="text-xl text-sky-300">El script definitivo para limpieza, actualización y rendimiento sin precedentes.</p>
        </header>

        <main>
            <div class="grid md:grid-cols-2 lg:grid-cols-3 gap-6 mb-12">
                <div class="feature-card">
                    <h3 class="text-xl font-bold text-sky-400 mb-2">Limpieza de Nivel Profundo</h3>
                    <p class="text-slate-400">Elimina cachés ocultas, informes de error y archivos temporales para recuperar el máximo espacio.</p>
                </div>
                <div class="feature-card">
                    <h3 class="text-xl font-bold text-sky-400 mb-2">Actualizador Universal</h3>
                    <p class="text-slate-400">Actualiza Windows y todos tus programas de terceros (Chrome, VLC, etc.) de una sola vez con Winget.</p>
                </div>
                 <div class="feature-card">
                    <h3 class="text-xl font-bold text-sky-400 mb-2">Rendimiento Extremo</h3>
                    <p class="text-slate-400">Optimiza la red, los efectos visuales y la energía para una fluidez y velocidad de respuesta máximas.</p>
                </div>
            </div>

            <!-- INSTRUCCIONES DE USO -->
            <div class="bg-slate-900 border border-slate-700 p-6 rounded-lg mb-8">
                <h2 class="text-2xl font-semibold text-white mb-4">Instrucciones para Desatar el Poder</h2>
                <ol class="list-decimal list-inside space-y-3 text-slate-300">
                    <li>Haz clic en el botón <strong>"Copiar Script Titán"</strong>.</li>
                    <li>Abre el menú Inicio, escribe <strong>"PowerShell"</strong>, haz clic derecho y selecciona <strong>"Ejecutar como administrador"</strong>.</li>
                    <li>En la ventana azul de PowerShell, haz clic derecho para pegar el script.</li>
                    <li>Presiona <strong>Enter</strong> y observa cómo se ejecuta la optimización más completa.</li>
                    <li>Presta atención a las instrucciones en pantalla, especialmente durante la actualización de programas.</li>
                </ol>
            </div>

            <!-- BLOQUE DEL SCRIPT -->
            <div>
                <h2 class="text-3xl font-bold text-white mb-4 text-center">Script de Optimización Titán</h2>
                <div class="code-block">
                    <button id="copyButton" class="copy-button">Copiar Script Titán</button>
                    <pre><code id="powerShellScript">
# =================================================================================
# ||                   SCRIPT DE OPTIMIZACIÓN TITÁN PARA WINDOWS                   ||
# ||          Limpieza Profunda | Actualización Universal | Rendimiento Máximo     ||
# =================================================================================

Function Show-Intro {
    Clear-Host
    Write-Host "=====================================================" -ForegroundColor Cyan
    Write-Host "     INICIANDO SCRIPT DE OPTIMIZACIÓN TITÁN" -ForegroundColor Cyan
    Write-Host "=====================================================" -ForegroundColor Gray
    Write-Host "Este script es el más completo y seguro para maximizar el rendimiento."
    Write-Host "Por favor, guarda tu trabajo. El proceso puede ser largo, especialmente"
    Write-Host "durante la actualización de programas." -ForegroundColor Yellow
    Write-Host "====================================================="
    Start-Sleep -Seconds 6
}

# --- PASO 1: LIMPIEZA DE NIVEL PROFUNDO ---
Function Step1-Deep-Cleanup {
    Write-Host "`n[PASO 1 de 7] - Iniciando Limpieza de Nivel Profundo..." -ForegroundColor Green
    $Locations = @(
        "$env:windir\Temp\*",
        "$env:TEMP\*",
        "$env:windir\SoftwareDistribution\Download\*",
        "$env:windir\Prefetch\*",
        "$env:windir\Logs\CBS\*.log",
        "$env:ProgramData\Microsoft\Windows\WER\ReportQueue\*",
        "$env:windir\ServiceProfiles\NetworkService\AppData\Local\Microsoft\Windows\DeliveryOptimization\Cache\*"
    )
    foreach ($loc in $Locations) {
        Write-Host " - Vaciando: $($loc.Split('\')[-2])" -ForegroundColor Gray
        Remove-Item -Path $loc -Recurse -Force -ErrorAction SilentlyContinue
    }
    Write-Host " - Limpiando caché de la Tienda de Windows..."
    $wsresetPath = "$env:SystemRoot\System32\WSReset.exe"; if (Test-Path $wsresetPath) { Start-Process $wsresetPath -Wait -WindowStyle Hidden }
    Write-Host " - Vaciando la Papelera de Reciclaje..."
    Clear-RecycleBin -Force -ErrorAction SilentlyContinue
    Write-Host " - Limpiando caché de DNS..."
    ipconfig /flushdns
    Write-Host " - Reconstruyendo caché de iconos (se reiniciará el explorador al final)..."
    if (Test-Path "$env:LOCALAPPDATA\IconCache.db") { Remove-Item "$env:LOCALAPPDATA\IconCache.db" -Force -ErrorAction SilentlyContinue }
}

# --- PASO 2: MANTENIMIENTO Y REPARACIÓN INTEGRAL ---
Function Step2-System-Repair {
    Write-Host "`n[PASO 2 de 7] - Verificando y reparando la integridad del sistema..." -ForegroundColor Green
    Write-Host " - Ejecutando System File Checker (SFC)..." -ForegroundColor Yellow
    sfc /scannow
    Write-Host " - Ejecutando DISM para reparar la imagen de Windows..." -ForegroundColor Yellow
    DISM /Online /Cleanup-Image /RestoreHealth
}

# --- PASO 3: ACTUALIZADOR UNIVERSAL (WINDOWS Y APPS) ---
Function Step3-Update-Everything {
    Write-Host "`n[PASO 3 de 7] - Iniciando Actualizador Universal..." -ForegroundColor Green
    Write-Host " - Buscando e instalando actualizaciones de Windows..." -ForegroundColor White
    try {
        UsoClient.exe StartInteractiveScan
        Write-Host "   Se ha iniciado el proceso de Windows Update. Revisa la configuración si requiere tu atención." -ForegroundColor Gray
    } catch { Write-Host "   No se pudo iniciar UsoClient.exe. Por favor, busca actualizaciones manualmente." -ForegroundColor Yellow }
    
    Write-Host "`n - Buscando actualizaciones para programas de terceros con Winget..." -ForegroundColor White
    Write-Host "   Esto puede tardar MUCHO TIEMPO. Winget buscará y actualizará todo lo posible." -ForegroundColor Yellow
    Read-Host "Presiona ENTER para comenzar la actualización de programas..."
    try {
        winget upgrade --all --accept-source-agreements --accept-package-agreements --silent --disable-interactivity
    } catch {
        Write-Host "   Winget no está disponible o falló. Omite este paso o instálalo desde la Microsoft Store." -ForegroundColor Red
    }
}

# --- PASO 4: OPTIMIZACIÓN DE DISCO INTELIGENTE ---
Function Step4-Disk-Optimization {
    Write-Host "`n[PASO 4 de 7] - Optimizando el disco del sistema..." -ForegroundColor Green
    $SystemDrive = Get-CimInstance -ClassName Win32_LogicalDisk | Where-Object { $_.DeviceID -eq $env:SystemDrive }
    if ($SystemDrive.MediaType -eq 4) {
        Write-Host " - Optimizando SSD (TRIM)..." -ForegroundColor White
        Optimize-Volume -DriveLetter $env:SystemDrive.Substring(0,1) -ReTrim -Verbose
    } else {
        Write-Host " - Desfragmentando HDD..." -ForegroundColor White
        Optimize-Volume -DriveLetter $env:SystemDrive.Substring(0,1) -Defrag -Verbose
    }
}

# --- PASO 5: AJUSTES AVANZADOS DE RENDIMIENTO Y RED ---
Function Step5-Performance-Tweaks {
    Write-Host "`n[PASO 5 de 7] - Aplicando ajustes avanzados de rendimiento..." -ForegroundColor Green
    Write-Host " - Activando plan de energía 'Máximo Rendimiento'..."
    powercfg /s e9a42b02-d5df-448d-aa00-03f14749eb61 | Out-Null
    Write-Host " - Optimizando efectos visuales para máxima fluidez..."
    Set-ItemProperty -Path 'HKCU:\Software\Microsoft\Windows\CurrentVersion\Explorer\VisualEffects' -Name 'VisualFxSetting' -Value 2
    Set-ItemProperty -Path 'HKCU:\Control Panel\Desktop' -Name 'FontSmoothing' -Value '2'
    Write-Host " - Aplicando optimizaciones de red..."
    netsh int tcp set global autotuninglevel=normal
    netsh int tcp set global congestionprovider=ctcp
    netsh int tcp set global ecncapability=enabled
}

# --- PASO 6: DEBLOAT Y CONTROL DE INICIO ---
Function Step6-Debloat-Startup {
    Write-Host "`n[PASO 6 de 7] - Asistente de Debloat y control de inicio..." -ForegroundColor Green
    Write-Host " - A continuación se abrirá el Administrador de Tareas en 'Aplicaciones de arranque'." -ForegroundColor Yellow
    Write-Host " - Por favor, DESHABILITA cualquier programa que no necesites que se inicie con Windows." -ForegroundColor Yellow
    Read-Host "Presiona ENTER para abrir el Administrador de Tareas..."
    Start-Process -FilePath "ms-settings:startupapps"
    
    Write-Host "`n - Ahora se abrirá el panel para desinstalar programas." -ForegroundColor Yellow
    Write-Host " - Desinstala todo el software que ya no utilices." -ForegroundColor Yellow
    Read-Host "Presiona ENTER para abrir 'Programas y características'..."
    control.exe appwiz.cpl
}

# --- PASO 7: FINALIZACIÓN Y REINICIO DE INTERFAZ ---
Function Step7-Finalize {
    Write-Host "`n[PASO 7 de 7] - Finalizando y aplicando cambios..." -ForegroundColor Green
    Write-Host " - Reiniciando el Explorador de Windows para aplicar la nueva caché de iconos..."
    Stop-Process -Name explorer -Force
    Write-Host "`n`n=====================================================" -ForegroundColor Cyan
    Write-Host "¡OPTIMIZACIÓN TITÁN COMPLETADA!" -ForegroundColor Cyan
    Write-Host "Se ha limpiado, reparado, actualizado y optimizado tu sistema." -ForegroundColor White
    Write-Host "Para una máxima efectividad, REINICIA TU EQUIPO ahora." -ForegroundColor Yellow
    Write-Host "====================================================="
}

# --- EJECUCIÓN DEL SCRIPT ---
Show-Intro
Step1-Deep-Cleanup
Step2-System-Repair
Step3-Update-Everything
Step4-Disk-Optimization
Step5-Performance-Tweaks
Step6-Debloat-Startup
Step7-Finalize

                    </code></pre>
                </div>
            </div>
        </main>
        
        <footer class="text-center text-slate-500 mt-12">
            <p>&copy; 2024. Siente el poder de un sistema completamente optimizado.</p>
        </footer>
    </div>

    <script>
        document.getElementById('copyButton').addEventListener('click', function() {
            const scriptText = document.getElementById('powerShellScript').textContent;
            const textArea = document.createElement('textarea');
            textArea.value = scriptText;
            document.body.appendChild(textArea);
            textArea.select();
            try {
                document.execCommand('copy');
                this.textContent = '¡Copiado!';
                this.style.backgroundColor = '#10B981'; // emerald-500
                this.style.color = '#fff';
            } catch (err) {
                this.textContent = 'Error';
                this.style.backgroundColor = '#EF4444'; // red-500
                console.error('No se pudo copiar el texto: ', err);
            }
            document.body.removeChild(textArea);
            
            setTimeout(() => {
                this.textContent = 'Copiar Script Titán';
                this.style.backgroundColor = '#1e293b';
                this.style.color = '#94a3b8';
            }, 3000);
        });
    </script>
</body>
</html>
