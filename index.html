<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>OptiClean‑Xtreme v11.0 — Ultra Optimizado (Seguro)</title>
    
    <!-- Preload Critical Resources -->
    <link rel="preload" href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" as="style">
    <link rel="preload" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" as="style">
    
    <!-- External Resources -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <link href="https://unpkg.com/aos@2.3.1/dist/aos.css" rel="stylesheet">
    
    <style>
        /* CSS Variables for Theming */
        :root {
            --primary-gradient: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            --secondary-gradient: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            --success-gradient: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            --dark-bg: #0f0f23;
            --card-bg: rgba(30, 30, 60, 0.8);
            --glass-bg: rgba(255, 255, 255, 0.1);
            --text-primary: #ffffff;
            --text-secondary: #b8c5d6;
            --text-accent: #64ffda;
            --border-color: rgba(255, 255, 255, 0.2);
            --shadow-lg: 0 20px 40px rgba(0, 0, 0, 0.3);
            --shadow-xl: 0 30px 60px rgba(0, 0, 0, 0.4);
            --blur-amount: 20px;
            --animation-speed: 0.6s;
            --border-radius: 20px;
        }

        /* Reset and Base Styles */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        html {
            scroll-behavior: smooth;
            font-size: 16px;
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
            background: var(--dark-bg);
            color: var(--text-primary);
            min-height: 100vh;
            overflow-x: hidden;
            position: relative;
            line-height: 1.6;
        }

        /* Animated Background */
        .animated-bg {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -2;
            background: linear-gradient(-45deg, #0f0f23, #1a1a3a, #2d1b69, #11998e);
            background-size: 400% 400%;
            animation: gradientShift 15s ease infinite;
        }

        @keyframes gradientShift {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }

        /* Particles Background */
        .particles {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -1;
            overflow: hidden;
        }

        .particle {
            position: absolute;
            width: 2px;
            height: 2px;
            background: var(--text-accent);
            border-radius: 50%;
            animation: float 20s infinite linear;
            opacity: 0.7;
        }

        @keyframes float {
            0% {
                transform: translateY(100vh) rotate(0deg);
                opacity: 0;
            }
            10% {
                opacity: 0.7;
            }
            90% {
                opacity: 0.7;
            }
            100% {
                transform: translateY(-100px) rotate(360deg);
                opacity: 0;
            }
        }

        /* Main Container */
        .main-container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 2rem;
            position: relative;
            z-index: 1;
        }

        /* Glass Card */
        .glass-card {
            background: var(--card-bg);
            backdrop-filter: blur(var(--blur-amount));
            -webkit-backdrop-filter: blur(var(--blur-amount));
            border: 1px solid var(--border-color);
            border-radius: var(--border-radius);
            box-shadow: var(--shadow-xl);
            overflow: hidden;
            position: relative;
            transform: translateY(20px);
            opacity: 0;
            animation: fadeInUp var(--animation-speed) ease forwards;
        }

        @keyframes fadeInUp {
            to {
                transform: translateY(0);
                opacity: 1;
            }
        }

        /* Header Section */
        .header {
            padding: 3rem;
            background: linear-gradient(135deg, rgba(102, 126, 234, 0.1) 0%, rgba(118, 75, 162, 0.1) 100%);
            border-bottom: 1px solid var(--border-color);
            position: relative;
        }

        .header::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 1px;
            background: var(--primary-gradient);
        }

        .title {
            font-size: clamp(1.8rem, 4vw, 3rem);
            font-weight: 800;
            background: var(--primary-gradient);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 0.5rem;
            position: relative;
            display: inline-block;
        }

        .title::after {
            content: '';
            position: absolute;
            bottom: -10px;
            left: 0;
            width: 0;
            height: 3px;
            background: var(--success-gradient);
            animation: titleUnderline 2s ease forwards 0.5s;
        }

        @keyframes titleUnderline {
            to {
                width: 100%;
            }
        }

        .subtitle {
            font-size: 1.2rem;
            color: var(--text-secondary);
            margin-bottom: 2rem;
            font-weight: 500;
        }

        /* Feature List */
        .features-list {
            list-style: none;
            display: grid;
            gap: 1rem;
        }

        .feature-item {
            display: flex;
            align-items: flex-start;
            gap: 1rem;
            padding: 1rem;
            background: var(--glass-bg);
            border-radius: 12px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            transition: all var(--animation-speed) ease;
            transform: translateX(-20px);
            opacity: 0;
            animation: slideInLeft var(--animation-speed) ease forwards;
        }

        .feature-item:nth-child(1) { animation-delay: 0.1s; }
        .feature-item:nth-child(2) { animation-delay: 0.2s; }
        .feature-item:nth-child(3) { animation-delay: 0.3s; }
        .feature-item:nth-child(4) { animation-delay: 0.4s; }
        .feature-item:nth-child(5) { animation-delay: 0.5s; }
        .feature-item:nth-child(6) { animation-delay: 0.6s; }
        .feature-item:nth-child(7) { animation-delay: 0.7s; }
        .feature-item:nth-child(8) { animation-delay: 0.8s; }

        @keyframes slideInLeft {
            to {
                transform: translateX(0);
                opacity: 1;
            }
        }

        .feature-item:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 30px rgba(100, 255, 218, 0.2);
            border-color: var(--text-accent);
        }

        .feature-icon {
            width: 24px;
            height: 24px;
            display: flex;
            align-items: center;
            justify-content: center;
            background: var(--success-gradient);
            color: white;
            border-radius: 50%;
            flex-shrink: 0;
            font-size: 12px;
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.1); }
        }

        .new-badge {
            background: var(--secondary-gradient);
            color: white;
            padding: 0.2rem 0.6rem;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            animation: glow 2s ease-in-out infinite alternate;
        }

        @keyframes glow {
            from { box-shadow: 0 0 10px rgba(240, 147, 251, 0.5); }
            to { box-shadow: 0 0 20px rgba(240, 147, 251, 0.8); }
        }

        /* Script Section */
        .script-section {
            position: relative;
            background: rgba(15, 15, 35, 0.9);
            min-height: 60vh;
        }

        .script-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 1.5rem 2rem;
            background: rgba(255, 255, 255, 0.05);
            border-bottom: 1px solid var(--border-color);
        }

        .script-title {
            font-size: 1.1rem;
            font-weight: 600;
            color: var(--text-accent);
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .action-buttons {
            display: flex;
            gap: 1rem;
            flex-wrap: wrap;
        }

        .btn {
            padding: 0.75rem 1.5rem;
            border: none;
            border-radius: 12px;
            font-weight: 600;
            font-size: 0.9rem;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
            text-decoration: none;
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            transform: translateY(0);
        }

        .btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
            transition: left 0.5s;
        }

        .btn:hover::before {
            left: 100%;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.3);
        }

        .btn:active {
            transform: translateY(0);
        }

        .btn-primary {
            background: var(--primary-gradient);
            color: white;
        }

        .btn-secondary {
            background: rgba(255, 255, 255, 0.1);
            color: var(--text-primary);
            border: 1px solid var(--border-color);
        }

        .btn-success {
            background: var(--success-gradient);
            color: white;
        }

        /* Code Container */
        .code-container {
            position: relative;
            max-height: 70vh;
            overflow: auto;
            background: linear-gradient(135deg, #0a0a0a 0%, #1a1a2e 100%);
        }

        .code-container::-webkit-scrollbar {
            width: 12px;
            height: 12px;
        }

        .code-container::-webkit-scrollbar-track {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
        }

        .code-container::-webkit-scrollbar-thumb {
            background: var(--primary-gradient);
            border-radius: 10px;
            border: 2px solid transparent;
            background-clip: content-box;
        }

        .code-container::-webkit-scrollbar-thumb:hover {
            background: var(--success-gradient);
            background-clip: content-box;
        }

        .code-block {
            padding: 2rem;
            font-family: 'JetBrains Mono', 'Fira Code', Consolas, monospace;
            font-size: clamp(0.75rem, 1.5vw, 0.9rem);
            line-height: 1.6;
            color: #e2e8f0;
            white-space: pre-wrap;
            word-break: break-word;
            background: transparent;
            border: none;
            outline: none;
            resize: none;
            width: 100%;
            min-height: 50vh;
        }

        /* Syntax Highlighting */
        .keyword { color: #ff6b6b; }
        .string { color: #4ecdc4; }
        .comment { color: #95a5a6; font-style: italic; }
        .function { color: #f39c12; }
        .variable { color: #9b59b6; }

        /* Instructions Section */
        .instructions {
            padding: 3rem;
            background: linear-gradient(135deg, rgba(79, 172, 254, 0.1) 0%, rgba(0, 242, 254, 0.1) 100%);
            border-top: 1px solid var(--border-color);
        }

        .instructions-title {
            font-size: 1.5rem;
            font-weight: 700;
            margin-bottom: 2rem;
            color: var(--text-accent);
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .instructions-list {
            list-style: none;
            counter-reset: step-counter;
            display: grid;
            gap: 1.5rem;
        }

        .instruction-item {
            counter-increment: step-counter;
            display: flex;
            align-items: flex-start;
            gap: 1rem;
            padding: 1.5rem;
            background: var(--glass-bg);
            border-radius: 15px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            position: relative;
            transition: all 0.3s ease;
        }

        .instruction-item::before {
            content: counter(step-counter);
            display: flex;
            align-items: center;
            justify-content: center;
            width: 40px;
            height: 40px;
            background: var(--primary-gradient);
            color: white;
            border-radius: 50%;
            font-weight: 700;
            font-size: 1.1rem;
            flex-shrink: 0;
        }

        .instruction-item:hover {
            transform: translateX(10px);
            border-color: var(--text-accent);
            box-shadow: 0 10px 30px rgba(100, 255, 218, 0.2);
        }

        .security-note {
            margin-top: 2rem;
            padding: 1.5rem;
            background: rgba(255, 193, 7, 0.1);
            border: 1px solid rgba(255, 193, 7, 0.3);
            border-radius: 15px;
            color: #ffd700;
            font-size: 0.95rem;
            position: relative;
        }

        .security-note::before {
            content: '\f071';
            font-family: 'Font Awesome 6 Free';
            font-weight: 900;
            position: absolute;
            top: 1rem;
            left: 1rem;
            font-size: 1.2rem;
            color: #ffd700;
        }

        .security-note-content {
            margin-left: 2rem;
        }

        /* Progress Indicator */
        .progress-ring {
            position: fixed;
            top: 20px;
            right: 20px;
            width: 60px;
            height: 60px;
            z-index: 1000;
            transform: rotate(-90deg);
        }

        .progress-ring-circle {
            stroke: var(--text-accent);
            stroke-width: 3;
            fill: transparent;
            stroke-dasharray: 157;
            stroke-dashoffset: 157;
            transition: stroke-dashoffset 0.3s ease;
        }

        .progress-ring-bg {
            stroke: rgba(255, 255, 255, 0.1);
            stroke-width: 3;
            fill: transparent;
        }

        /* Loading Spinner */
        .loading-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(15, 15, 35, 0.9);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 9999;
            opacity: 1;
            transition: opacity 0.5s ease;
        }

        .loading-overlay.hidden {
            opacity: 0;
            pointer-events: none;
        }

        .spinner {
            width: 80px;
            height: 80px;
            border: 3px solid rgba(255, 255, 255, 0.1);
            border-top: 3px solid var(--text-accent);
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .loading-text {
            position: absolute;
            bottom: -60px;
            color: var(--text-accent);
            font-weight: 600;
            animation: fadeInOut 2s ease-in-out infinite;
        }

        @keyframes fadeInOut {
            0%, 100% { opacity: 0.5; }
            50% { opacity: 1; }
        }

        /* Floating Action Button */
        .fab {
            position: fixed;
            bottom: 30px;
            right: 30px;
            width: 60px;
            height: 60px;
            background: var(--primary-gradient);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 1.5rem;
            text-decoration: none;
            box-shadow: 0 10px 25px rgba(102, 126, 234, 0.4);
            transition: all 0.3s ease;
            z-index: 1000;
            animation: fabPulse 3s ease-in-out infinite;
        }

        @keyframes fabPulse {
            0%, 100% {
                transform: scale(1);
                box-shadow: 0 10px 25px rgba(102, 126, 234, 0.4);
            }
            50% {
                transform: scale(1.1);
                box-shadow: 0 15px 35px rgba(102, 126, 234, 0.6);
            }
        }

        .fab:hover {
            transform: scale(1.15);
            box-shadow: 0 15px 35px rgba(102, 126, 234, 0.6);
        }

        /* Tooltip */
        .tooltip {
            position: relative;
            display: inline-block;
        }

        .tooltip .tooltiptext {
            visibility: hidden;
            width: 200px;
            background: rgba(0, 0, 0, 0.9);
            color: white;
            text-align: center;
            border-radius: 8px;
            padding: 8px;
            position: absolute;
            z-index: 1;
            bottom: 125%;
            left: 50%;
            margin-left: -100px;
            opacity: 0;
            transition: opacity 0.3s;
            font-size: 0.8rem;
        }

        .tooltip:hover .tooltiptext {
            visibility: visible;
            opacity: 1;
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            .main-container {
                padding: 1rem;
            }

            .header {
                padding: 2rem 1.5rem;
            }

            .script-header {
                padding: 1rem;
                flex-direction: column;
                gap: 1rem;
                align-items: stretch;
            }

            .action-buttons {
                justify-content: center;
            }

            .instructions {
                padding: 2rem 1.5rem;
            }

            .instruction-item {
                padding: 1rem;
            }

            .fab {
                bottom: 20px;
                right: 20px;
                width: 50px;
                height: 50px;
                font-size: 1.2rem;
            }

            .progress-ring {
                width: 50px;
                height: 50px;
                top: 15px;
                right: 15px;
            }

            .features-list {
                gap: 0.8rem;
            }

            .feature-item {
                padding: 0.8rem;
            }
        }

        @media (max-width: 480px) {
            .title {
                font-size: 1.8rem;
            }

            .subtitle {
                font-size: 1rem;
            }

            .code-block {
                font-size: 0.7rem;
                padding: 1rem;
            }

            .btn {
                padding: 0.6rem 1rem;
                font-size: 0.8rem;
            }
        }

        /* Print Styles */
        @media print {
            .loading-overlay,
            .fab,
            .progress-ring,
            .particles,
            .animated-bg {
                display: none !important;
            }

            .glass-card {
                background: white;
                color: black;
                box-shadow: none;
                border: 1px solid #ccc;
            }

            .code-container {
                max-height: none;
                overflow: visible;
            }
        }

        /* Accessibility Improvements */
        @media (prefers-reduced-motion: reduce) {
            *,
            *::before,
            *::after {
                animation-duration: 0.01ms !important;
                animation-iteration-count: 1 !important;
                transition-duration: 0.01ms !important;
            }

            .particles {
                display: none;
            }

            .animated-bg {
                animation: none;
                background: var(--dark-bg);
            }
        }

        /* Focus Styles for Accessibility */
        .btn:focus,
        .code-block:focus {
            outline: 2px solid var(--text-accent);
            outline-offset: 2px;
        }

        /* High Contrast Mode */
        @media (prefers-contrast: high) {
            :root {
                --card-bg: rgba(0, 0, 0, 0.9);
                --border-color: rgba(255, 255, 255, 0.5);
                --text-secondary: #ffffff;
            }
        }
    </style>
</head>
<body>
    <!-- Loading Screen -->
    <div class="loading-overlay" id="loadingOverlay">
        <div class="spinner"></div>
        <div class="loading-text">Cargando OptiClean‑Xtreme...</div>
    </div>

    <!-- Animated Background -->
    <div class="animated-bg"></div>

    <!-- Particles Background -->
    <div class="particles" id="particles"></div>

    <!-- Progress Ring -->
    <div class="progress-ring">
        <svg width="60" height="60">
            <circle class="progress-ring-bg" cx="30" cy="30" r="25"></circle>
            <circle class="progress-ring-circle" cx="30" cy="30" r="25" id="progressCircle"></circle>
        </svg>
    </div>

    <!-- Main Container -->
    <main class="main-container">
        <article class="glass-card" data-aos="fade-up" data-aos-duration="800">
            <!-- Header Section -->
            <header class="header">
                <h1 class="title">
                    <i class="fas fa-rocket" aria-hidden="true"></i>
                    OptiClean‑Xtreme v11.0
                </h1>
                <p class="subtitle">
                    Optimización y reparación <strong>máxima</strong> para Windows — Perfil "Turbo Seguro Plus"
                </p>
                
                <ul class="features-list" role="list">
                    <li class="feature-item" data-aos="slide-right" data-aos-delay="100">
                        <div class="feature-icon">
                            <i class="fas fa-star"></i>
                        </div>
                        <div>
                            <span class="new-badge" aria-label="Nueva característica">¡NUEVO!</span>
                            Actualización integral de software con <strong>Winget</strong> (Windows, Office, drivers y apps de la Store/terceros).
                        </div>
                    </li>
                    <li class="feature-item" data-aos="slide-right" data-aos-delay="200">
                        <div class="feature-icon">
                            <i class="fas fa-star"></i>
                        </div>
                        <div>
                            <span class="new-badge" aria-label="Nueva característica">¡NUEVO!</span>
                            Limpieza de caché de <strong>instaladores de Windows (WinSxS)</strong> para ahorrar espacio en disco SSD.
                        </div>
                    </li>
                    <li class="feature-item" data-aos="slide-right" data-aos-delay="300">
                        <div class="feature-icon">
                            <i class="fas fa-star"></i>
                        </div>
                        <div>
                            <span class="new-badge" aria-label="Nueva característica">¡NUEVO!</span>
                            Optimización de red avanzada (DNS, TCP, QoS) para mejorar latencia y velocidad.
                        </div>
                    </li>
                    <li class="feature-item" data-aos="slide-right" data-aos-delay="400">
                        <div class="feature-icon">
                            <i class="fas fa-cog"></i>
                        </div>
                        <div>Limpieza extendida de archivos basura y cachés de sistema/aplicaciones.</div>
                    </li>
                    <li class="feature-item" data-aos="slide-right" data-aos-delay="500">
                        <div class="feature-icon">
                            <i class="fas fa-shield-alt"></i>
                        </div>
                        <div>Eliminación segura y ampliada de Bloatware (no afecta funciones esenciales).</div>
                    </li>
                    <li class="feature-item" data-aos="slide-right" data-aos-delay="600">
                        <div class="feature-icon">
                            <i class="fas fa-wrench"></i>
                        </div>
                        <div>Reparación completa del sistema (DISM, SFC) y reseteo de cachés (GPU, Store, Office, Red).</div>
                    </li>
                    <li class="feature-item" data-aos="slide-right" data-aos-delay="700">
                        <div class="feature-icon">
                            <i class="fas fa-tachometer-alt"></i>
                        </div>
                        <div>Privacidad reforzada, arranque más rápido y plan de energía de <strong>Máximo Rendimiento</strong>.</div>
                    </li>
                    <li class="feature-item" data-aos="slide-right" data-aos-delay="800">
                        <div class="feature-icon">
                            <i class="fas fa-undo"></i>
                        </div>
                        <div>
                            <strong style="color: #ffd700;">Modo reversible:</strong> crea un Punto de Restauración y conserva un log detallado de cada acción.
                        </div>
                    </li>
                </ul>
            </header>

            <!-- Script Section -->
            <section class="script-section" data-aos="fade-up" data-aos-delay="200">
                <div class="script-header">
                    <h2 class="script-title">
                        <i class="fas fa-code"></i>
                        Script PowerShell
                    </h2>
                    <div class="action-buttons">
                        <button 
                            id="copyButton" 
                            class="btn btn-primary tooltip"
                            aria-label="Copiar script al portapapeles"
                        >
                            <i class="fas fa-copy"></i>
                            Copiar Script
                            <span class="tooltiptext">Copia el script completo al portapapeles</span>
                        </button>
                        <button 
                            id="downloadButton" 
                            class="btn btn-secondary tooltip"
                            aria-label="Descargar archivo PowerShell"
                        >
                            <i class="fas fa-download"></i>
                            Descargar .ps1
                            <span class="tooltiptext">Descarga el script como archivo .ps1</span>
                        </button>
                    </div>
                </div>
                <div class="code-container" id="scriptContainer">
                    <textarea 
                        class="code-block" 
                        id="codeBlock" 
                        readonly 
                        aria-label="Código del script PowerShell"
                        tabindex="0"
                    ></textarea>
                </div>
            </section>

            <!-- Instructions Section -->
            <section class="instructions" data-aos="fade-up" data-aos-delay="300">
                <h2 class="instructions-title">
                    <i class="fas fa-list-ol"></i>
                    Instrucciones de Uso
                </h2>
                <ol class="instructions-list" role="list">
                    <li class="instruction-item" data-aos="fade-up" data-aos-delay="400">
                        <div>
                            Haz clic en <strong>Copiar Script</strong> o <strong>Descargar .ps1</strong> para obtener el código.
                        </div>
                    </li>
                    <li class="instruction-item" data-aos="fade-up" data-aos-delay="500">
                        <div>
                            Abre <strong>PowerShell</strong> o <strong>Terminal</strong> (búscalo en Inicio, clic derecho → <strong>Ejecutar como Administrador</strong>).
                        </div>
                    </li>
                    <li class="instruction-item" data-aos="fade-up" data-aos-delay="600">
                        <div>
                            Ejecuta el script. Si lo copiaste, pégalo y presiona Enter. Si lo descargaste, navega a la carpeta y ejecuta <code>.\OptiClean_Xtreme_v11.ps1</code>.
                        </div>
                    </li>
                    <li class="instruction-item" data-aos="fade-up" data-aos-delay="700">
                        <div>
                            El proceso puede tardar, especialmente la actualización con Winget. <strong>Sé paciente</strong>.
                        </div>
                    </li>
                    <li class="instruction-item" data-aos="fade-up" data-aos-delay="800">
                        <div>
                            Al finalizar, <strong>reinicia</strong> el equipo para aplicar todos los cambios.
                        </div>
                    </li>
                </ol>

                <div class="security-note" data-aos="fade-up" data-aos-delay="900">
                    <div class="security-note-content">
                        <strong>Nota de seguridad:</strong> Este script está diseñado para ser seguro y no eliminará archivos personales. 
                        No desactiva Windows Update, Defender ni la Búsqueda. Los cambios son reversibles a través del Punto de Restauración creado.
                    </div>
                </div>
            </section>
        </article>
    </main>

    <!-- Floating Action Button -->
    <a href="#" class="fab tooltip" id="scrollToTop" aria-label="Volver al inicio">
        <i class="fas fa-chevron-up"></i>
        <span class="tooltiptext">Volver al inicio</span>
    </a>

    <!-- External Scripts -->
    <script src="https://unpkg.com/aos@2.3.1/dist/aos.js"></script>
    
    <script>
        // Script content
        const scriptContent = `#requires -version 5.1
<#
  .SYNOPSIS
  OptiClean‑Xtreme v11.0 — Perfil "Turbo Seguro Plus"
  .DESCRIPTION
  Un script integral para optimizar, limpiar, reparar y actualizar sistemas Windows 10/11.
  Diseñado para obtener el máximo rendimiento sin comprometer la estabilidad ni los archivos personales.
  .NOTES
  Autor: Gemini
  Versión: 11.0
  Principales mejoras sobre v10:
   - Integración completa de Winget para actualizar TODO: Windows, Office, drivers y apps de terceros.
   - Limpieza profunda del almacén de componentes de WinSxS (instaladores viejos de Windows Update).
   - Optimización de red avanzada: Flush DNS, reseteo de TCP/IP y Winsock.
   - Limpieza mejorada para cachés de desarrollo (Node.js/npm, Python/pip, VSCode).
   - Chequeo de salud del SSD/HDD con el comando integrado de Windows (SMART).
   - Lógica de registro y medición de espacio liberado mejorada.
  .SAFETY
  - Crea un Punto de Restauración antes de realizar cambios.
  - No elimina archivos personales (Documentos, Fotos, etc).
  - No deshabilita funciones críticas como Windows Defender, Windows Update o la Búsqueda.
#>
#region Preparación y Configuración
# --- Forzar la ejecución y configurar manejo de errores ---
Set-ExecutionPolicy -ExecutionPolicy Bypass -Scope Process -Force -ErrorAction SilentlyContinue
$ErrorActionPreference = 'SilentlyContinue'
# --- Variables Globales y Funciones de Ayuda ---
$Global:StartTime = Get-Date
$Global:FreedSpace = 0
$Global:Warnings = [System.Collections.Generic.List[string]]::new()
$LogPath = Join-Path $env:TEMP ("OptiClean_v11_" + (Get-Date -f 'yyyyMMdd_HHmmss') + ".log")
function Log([string]$message, [string]$color = 'Gray', [switch]$isWarning){
  $timestamp = Get-Date -f 'HH:mm:ss'
  $line = "[$timestamp] $message"
  Write-Host $line -ForegroundColor $color
  Add-Content -Path $LogPath -Value $line
  if($isWarning){ $Global:Warnings.Add($line) }
}
function Write-Section($title){
  Write-Host ""
  Write-Host ('-'*90) -ForegroundColor DarkGray
  Log $title 'Magenta'
  Write-Host ('-'*90) -ForegroundColor DarkGray
}
function Assert-Admin(){
  $currentUser = New-Object Security.Principal.WindowsPrincipal([Security.Principal.WindowsIdentity]::GetCurrent())
  if (-not $currentUser.IsInRole([Security.Principal.WindowsBuiltinRole]::Administrator)) {
    Log "Error: Este script requiere privilegios de Administrador." 'Red'
    Log "Por favor, haz clic derecho en PowerShell/Terminal y selecciona 'Ejecutar como Administrador'." 'Red'
    throw "Permisos insuficientes."
  }
}
function Measure-Task([scriptblock]$Action){
  $drive = Get-PSDrive $env:SystemDrive.Substring(0,1)
  $before = $drive.Free
  try { & $Action } catch { Log "Error durante la tarea: \$($_.Exception.Message)" 'DarkYellow' -isWarning }
  $after = (Get-PSDrive $drive.Name).Free
  $delta = $after - $before
  if($delta -gt 1MB){
    $Global:FreedSpace += $delta
    Log ("-> Espacio liberado: {0:N2} MB" -f ($delta/1MB)) 'Green'
  }
}
function Safe-Remove([string]$path){
    if(Test-Path -LiteralPath $path){
        try{ Remove-Item -LiteralPath $path -Recurse -Force -ErrorAction Stop }
        catch{ Log "No se pudo eliminar: $path (probablemente en uso)" 'DarkYellow' -isWarning }
    }
}
#endregion
#region Fase 1: Seguridad y Preparación
Write-Section '[1/8] Preparación y Punto de Restauración'
Assert-Admin
Log ("El registro detallado de esta sesión se guardará en: $LogPath") 'DarkGray'
try {
    Checkpoint-Computer -Description 'OptiClean v11 PRE-OPTIMIZATION' -RestorePointType 'MODIFY_SETTINGS' -ErrorAction Stop
    Log 'Punto de restauración creado con éxito. Tu sistema está seguro.' 'Green'
} catch {
    Log 'No se pudo crear el punto de restauración (puede estar deshabilitado en el sistema).' 'DarkYellow' -isWarning
}
#endregion
#region Fase 2: Limpieza Extrema de Archivos
Write-Section '[2/8] Limpieza Extrema (Cachés del Sistema, Apps y Residuos)'
Log "Limpiando archivos temporales del sistema y de todos los perfiles de usuario..." 'Cyan'
Measure-Task {
  $tempPaths = @(
    "$env:windir\\\\Temp\\\\*",
    "$env:TEMP\\\\*",
    "$env:SystemDrive\\\\Windows.old"
  )
  Get-ChildItem "$env:SystemDrive\\\\Users" -Directory -ErrorAction SilentlyContinue | ForEach-Object {
    $userProfile = $_.FullName
    $tempPaths += @(
      Join-Path $userProfile 'AppData\\\\Local\\\\Temp\\\\*',
      Join-Path $userProfile 'AppData\\\\Local\\\\CrashDumps\\\\*',
      Join-Path $userProfile 'AppData\\\\Local\\\\Microsoft\\\\Windows\\\\INetCache\\\\*'
    )
  }
  $tempPaths | ForEach-Object { Safe-Remove $_ }
}
Log "Vaciando Papelera de Reciclaje de todas las unidades..." 'Cyan'
Measure-Task {
    Get-PSDrive -PSProvider FileSystem | ForEach-Object {
        try { Clear-RecycleBin -DriveLetter $_.Name -Force -ErrorAction Stop } catch{}
    }
}
Log "Limpiando cachés de navegadores (Chrome, Edge, Firefox, Brave)..." 'Cyan'
Measure-Task {
  $browserPatterns = @(
   'AppData\\\\Local\\\\Microsoft\\\\Edge\\\\User Data\\\\*\\\\Cache', 'AppData\\\\Local\\\\Microsoft\\\\Edge\\\\User Data\\\\*\\\\Code Cache', 'AppData\\\\Local\\\\Microsoft\\\\Edge\\\\User Data\\\\*\\\\GPUCache',
   'AppData\\\\Local\\\\Google\\\\Chrome\\\\User Data\\\\*\\\\Cache', 'AppData\\\\Local\\\\Google\\\\Chrome\\\\User Data\\\\*\\\\Code Cache', 'AppData\\\\Local\\\\Google\\\\Chrome\\\\User Data\\\\*\\\\GPUCache',
   'AppData\\\\Local\\\\BraveSoftware\\\\Brave-Browser\\\\User Data\\\\*\\\\Cache',
   'AppData\\\\Roaming\\\\Mozilla\\\\Firefox\\\\Profiles\\\\*\\\\cache2'
  )
  Get-ChildItem "$env:SystemDrive\\\\Users" -Directory | ForEach-Object {
      $u = $_.FullName
      foreach($pattern in $browserPatterns){
          Get-ChildItem (Join-Path $u $pattern) -Recurse -Force -ErrorAction SilentlyContinue | Remove-Item -Recurse -Force -ErrorAction SilentlyContinue
      }
  }
}
Log "Limpiando cachés de apps comunes (Office, Discord, Steam, VSCode, NVIDIA/AMD)..." 'Cyan'
Measure-Task {
  $appCachePaths = @(
    "$env:APPDATA\\\\discord\\\\Cache", "$env:APPDATA\\\\discord\\\\Code Cache", "$env:APPDATA\\\\discord\\\\GPUCache",
    "$env:APPDATA\\\\Microsoft\\\\Teams\\\\Cache", "$env:APPDATA\\\\Microsoft\\\\Teams\\\\GPUCache",
    "$env:LOCALAPPDATA\\\\Microsoft\\\\Office\\\\16.0\\\\OfficeFileCache",
    "$env:LOCALAPPDATA\\\\NVIDIA\\\\DXCache", "$env:LOCALAPPDATA\\\\NVIDIA\\\\GLCache", "$env:ProgramData\\\\NVIDIA Corporation\\\\NV_Cache",
    "$env:LOCALAPPDATA\\\\AMD\\\\DxCache", "$env:LOCALAPPDATA\\\\D3DShaderCache",
    "$env:ProgramFiles (x86)\\\\Steam\\\\appcache", "$env:ProgramFiles (x86)\\\\Steam\\\\config\\\\htmlcache",
    "$env:LOCALAPPDATA\\\\Packages\\\\Microsoft.WindowsStore_8wekyb3d8bbwe\\\\LocalCache",
    "$env:APPDATA\\\\Code\\\\Cache*", "$env:APPDATA\\\\Code\\\\GPUCache",
    "$env:LOCALAPPDATA\\\\npm-cache", "$env:APPDATA\\\\npm-cache",
    (Join-Path $env:USERPROFILE ".node_repl_history"),
    (Join-Path $env:USERPROFILE "AppData\\\\Local\\\\pip\\\\cache")
  )
  $appCachePaths | ForEach-Object { Safe-Remove $_ }
}
Log "Limpiando cachés de Windows (Iconos, Fuentes, Prefetch) y reiniciando Explorer..." 'Cyan'
Measure-Task {
  Stop-Service SysMain -Force -ErrorAction SilentlyContinue; Safe-Remove "$env:windir\\\\Prefetch\\\\*"; Start-Service SysMain -ErrorAction SilentlyContinue
  Stop-Service FontCache -Force -ErrorAction SilentlyContinue; Safe-Remove "$env:windir\\\\ServiceProfiles\\\\LocalService\\\\AppData\\\\Local\\\\FontCache\\\\*.dat"; Start-Service FontCache -ErrorAction SilentlyContinue
  Stop-Process -Name explorer -Force -ErrorAction SilentlyContinue; Start-Sleep 1
  Safe-Remove "$env:LOCALAPPDATA\\\\Microsoft\\\\Windows\\\\Explorer\\\\thumbcache_*.db"
  Safe-Remove "$env:LOCALAPPDATA\\\\IconCache.db"
  Start-Process explorer | Out-Null
}
Log "Limpiando residuos de Windows Update y optimización de entrega..." 'Cyan'
Measure-Task {
  Stop-Service wuauserv,bits,dosvc -Force -ErrorAction SilentlyContinue
  Safe-Remove "$env:windir\\\\SoftwareDistribution\\\\Download\\\\*"
  Safe-Remove "$env:windir\\\\DeliveryOptimization\\\\Cache\\\\*"
  Start-Service wuauserv,bits,dosvc -ErrorAction SilentlyContinue
}
Log "Limpiando volcados de memoria, informes de errores y logs antiguos..." 'Cyan'
Measure-Task {
  Safe-Remove "$env:windir\\\\Minidump\\\\*"
  Safe-Remove "$env:ProgramData\\\\Microsoft\\\\Windows\\\\WER\\\\*"
  Safe-Remove "$env:SystemDrive\\\\MEMORY.DMP"
  Remove-Item "$env:windir\\\\Logs\\\\CBS\\\\*.log", "$env:windir\\\\Logs\\\\CBS\\\\*.cab" -Force -ErrorAction SilentlyContinue
}
#endregion
#region Fase 3: Actualización Integral con Winget
Write-Section '[3/8] Actualización Integral del Sistema con Winget'
Log 'Buscando e instalando actualizaciones para TODO (Windows, Office, Drivers, Apps)...' 'Cyan'
Log 'Este proceso es el más largo. Por favor, sé paciente mientras Winget trabaja.' 'Yellow'
try {
    winget upgrade --all --include-unknown --accept-package-agreements --accept-source-agreements --disable-interactivity --silent
    Log 'Actualización con Winget completada.' 'Green'
} catch {
    Log 'Winget no está disponible o falló. Omitiendo actualización automática.' 'DarkYellow' -isWarning
}
#endregion
#region Fase 4: Eliminación Segura de Bloatware
Write-Section '[4/8] Eliminación de Bloatware (Seguro)'
$bloatwarePatterns = @(
'*3DViewer*','*MixedReality*','*Print3D*','*SkypeApp*','*YourPhone*','*Solitaire*','*Zune*',
'*BingNews*','*BingWeather*','*GetHelp*','*Getstarted*','*FeedbackHub*','*OfficeHub*','*OneNote*',
'*People*','*Wallet*','*WindowsAlarms*','*WindowsMaps*','*Messaging*','*SoundRecorder*','*WindowsCamera*',
'*Clipchamp*','*Cortana*','*MicrosoftTeams*','*PowerAutomate*','*Todos*','*549981C3F5F10*', # Publisher ID for some OEM apps
'*Xbox*','*GamingApp*','*Microsoft.GamingApp*','*XboxGameOverlay*','*XboxIdentityProvider*','*XboxSpeechTo-TextOverlay*',
'*WebExperience*','*WindowsWidgets*'
)
Log "Eliminando bloatware preinstalado y aprovisionado..." 'Cyan'
$allPackages = Get-AppxPackage -AllUsers
$provisionedPackages = Get-AppxProvisionedPackage -Online
foreach($pattern in $bloatwarePatterns){
  $allPackages | Where-Object { $_.Name -like $pattern } | ForEach-Object {
      try { $_ | Remove-AppxPackage -AllUsers -ErrorAction Stop; Log "  [Quitado] \$($_.Name)" 'DarkGray' }
      catch { Log "  [Fallo al quitar] \$($_.Name)" 'DarkYellow' -isWarning }
  }
  $provisionedPackages | Where-Object { $_.DisplayName -like $pattern } | ForEach-Object {
      try { $_ | Remove-AppxProvisionedPackage -Online -ErrorAction Stop; Log "  [Quitada provisión] \$($_.DisplayName)" 'DarkGray' }
      catch { Log "  [Fallo al quitar provisión] \$($_.DisplayName)" 'DarkYellow' -isWarning }
  }
}
Log 'Debloat completado.' 'Green'
#endregion
#region Fase 5: Reparación y Salud del Sistema
Write-Section '[5/8] Reparaciones (DISM/SFC/Red/Store/WinSxS)'
Log 'Limpiando almacén de componentes (WinSxS) para recuperar espacio de antiguas actualizaciones...' 'Cyan'
Measure-Task {
    try {
        Dism.exe /Online /Cleanup-Image /StartComponentCleanup | Out-Null
        Log 'Limpieza de WinSxS completada.' 'Green'
    } catch {
        Log 'Fallo en la limpieza de WinSxS.' 'DarkYellow' -isWarning
    }
}
Log 'DISM RestoreHealth (reparando imagen del sistema desde Windows Update)...' 'Cyan'
try{ Dism.exe /Online /Cleanup-Image /RestoreHealth | Out-Null; Log 'RestoreHealth completado.' 'Green' } catch{ Log 'Fallo en RestoreHealth' 'DarkYellow' -isWarning }
Log 'SFC /scannow (verificando y reparando archivos de sistema)...' 'Cyan'
try{ sfc.exe /scannow | Out-Null; Log 'SFC completado.' 'Green' } catch{ Log 'Fallo en SFC' 'DarkYellow' -isWarning }
Log 'Reiniciando y optimizando pila de red para mejorar la conexión...' 'Cyan'
try{
    ipconfig /flushdns | Out-Null
    netsh winsock reset | Out-Null
    netsh int ip reset | Out-Null
    netsh int tcp set global autotuninglevel=normal
    netsh int tcp set global ecncapability=enabled
    Log 'Pila de red reseteada y optimizada.' 'Green'
} catch {
    Log 'Fallo en la optimización de red.' 'DarkYellow' -isWarning
}
Log 'WSReset (reseteando caché de la Tienda Windows)...' 'Cyan'
try{ Start-Process wsreset -Wait -WindowStyle Hidden; Log 'WSReset ejecutado.' 'Green' } catch{ Log 'WSReset no disponible o falló.' 'DarkYellow' -isWarning }
Log 'Re-registrando aplicaciones de la Tienda para corregir posibles errores...' 'Cyan'
Get-AppxPackage -AllUsers | ForEach-Object { try{ Add-AppxPackage -DisableDevelopmentMode -Register "\$($_.InstallLocation)\\\\AppXManifest.xml" -ErrorAction Stop } catch{} } | Out-Null
Log 'Re-registro de apps completado.' 'Green'
#endregion
#region Fase 6: Privacidad y Telemetría
Write-Section '[6/8] Privacidad (Telemetría Mínima)'
Log "Deshabilitando servicios y tareas de recolección de datos..." 'Cyan'
$telemetryServices = 'DiagTrack','dmwappushservice','diagsvc','PcaSvc','RemoteRegistry'
foreach($s in $telemetryServices){ if(Get-Service $s -ErrorAction SilentlyContinue){ try{ Set-Service $s -StartupType Disabled; Stop-Service $s -Force } catch{} } }
$telemetryTasks = @(
  '\\\\Microsoft\\\\Windows\\\\Application Experience\\\\Microsoft Compatibility Appraiser',
  '\\\\Microsoft\\\\Windows\\\\Customer Experience Improvement Program\\\\Consolidator'
)
foreach($t in $telemetryTasks){ try{ Get-ScheduledTask -TaskPath ($t.Substring(0,$t.LastIndexOf('\\\\'))) -TaskName ($t.Split('\\\\')[-1]) | Disable-ScheduledTask } catch{} }
Log "Aplicando configuración de privacidad en el registro..." 'Cyan'
$regKeys = @{
  'HKLM:SOFTWARE\\\\Policies\\\\Microsoft\\\\Windows\\\\DataCollection' = @{AllowTelemetry=0};
  'HKLM:SOFTWARE\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Policies\\\\DataCollection' = @{AllowTelemetry=0};
  'HKLM:SYSTEM\\\\CurrentControlSet\\\\Control\\\\WMI\\\\AutoLogger\\\\AutoLogger-Diagtrack-Listener' = @{Start=0};
  'HKCU:Software\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\AdvertisingInfo' = @{Enabled=0};
  'HKLM:SOFTWARE\\\\Policies\\\\Microsoft\\\\Windows\\\\CloudContent' = @{DisableWindowsConsumerFeatures=1};
}
foreach($key in $regKeys.Keys){
    if(-not (Test-Path $key)){ New-Item $key -Force | Out-Null }
    foreach($name in $regKeys[$key].Keys){
        try{ New-ItemProperty -Path $key -Name $name -Value $regKeys[$key][$name] -PropertyType DWord -Force | Out-Null } catch{}
    }
}
Log 'Configuración de privacidad aplicada.' 'Green'
#endregion
#region Fase 7: Optimización Final del Sistema
Write-Section '[7/8] Optimización Final (Energía, Arranque, Discos, UI)'
Log "Activando plan de energía 'Máximo Rendimiento' para exprimir cada gota de potencia..." 'Cyan'
$maxPerfGuid = 'e9a42b02-d5df-448d-aa00-03f14749eb61'
try{
    if(-not (powercfg -l | Select-String $maxPerfGuid -Quiet)){ powercfg -duplicatescheme $maxPerfGuid | Out-Null }
    powercfg -setactive $maxPerfGuid
    Log 'Plan de energía Máximo Rendimiento activado.' 'Green'
} catch {
    Log 'No se pudo activar el plan de energía.' 'DarkYellow' -isWarning
}
Log "Desactivando hibernación para liberar espacio en disco (seguro en SSD)..." 'Cyan'
Measure-Task { try{ powercfg -h off } catch{} }
Log "Configurando efectos visuales para 'Mejor Rendimiento'..." 'Cyan'
try{ Set-ItemProperty 'HKCU:Software\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Explorer\\\\VisualEffects' -Name VisualFXSetting -Value 2 -Type DWord -Force } catch{}
Log "Deshabilitando SysMain (Superfetch), a menudo redundante en SSDs modernos..." 'Cyan'
try{ if(Get-Service SysMain -ErrorAction SilentlyContinue){ Set-Service SysMain -StartupType Disabled; Stop-Service SysMain -Force } } catch{}
Log "Optimizando discos (TRIM para SSDs, Defrag para HDDs)..." 'Cyan'
try{
    Get-Volume | Where-Object { $_.DriveType -eq 'Fixed' -and $_.HealthStatus -eq 'Healthy' -and $_.DriveLetter } | ForEach-Object { Optimize-Volume -DriveLetter $_.DriveLetter -Defrag -ErrorAction SilentlyContinue }
    Log 'Discos optimizados.' 'Green'
} catch {
    Log 'Fallo al optimizar discos.' 'DarkYellow' -isWarning
}
Log "Verificando estado de salud de las unidades (SMART)..." 'Cyan'
try {
    $driveStatus = Get-CimInstance -Namespace root\\\\wmi -ClassName MSStorageDriver_FailurePredictStatus
    if ($driveStatus.PredictFailure) {
        Log "¡ALERTA! Una unidad de almacenamiento reporta problemas de salud (SMART)." 'Red' -isWarning
    } else {
        Log "Estado de salud de las unidades (SMART): OK." 'Green'
    }
} catch {
    Log "No se pudo verificar el estado de salud de las unidades (SMART)." 'DarkYellow' -isWarning
}
#endregion
#region Fase 8: Resumen Final
Write-Section '[8/8] Resumen Final'
$totalGB = [math]::Round($Global:FreedSpace/1GB, 3)
$totalMinutes = [math]::Round((New-TimeSpan -Start $Global:StartTime).TotalMinutes, 1)
Write-Host ""
Log ("------------------ TAREA COMPLETADA ------------------") 'White'
Log ("Espacio total liberado: ~{0} GB" -f $totalGB) 'Green'
Log ("Tiempo total de ejecución: {0} minutos" -f $totalMinutes) 'Green'
if($Global:Warnings.Count -gt 0){
    Log ("Se registraron $($Global:Warnings.Count) advertencias. Revisa el log para más detalles:") 'Yellow'
    Log ($LogPath) 'Yellow'
} else {
    Log 'El proceso finalizó sin advertencias.' 'Green'
}
Write-Host ""
Log '¡Listo! Se recomienda encarecidamente REINICIAR el equipo ahora para aplicar todos los cambios.' 'Cyan'
Log '----------------------------------------------------' 'White'
#endregion
`;

        // Initialize AOS (Animate On Scroll)
        AOS.init({
            duration: 800,
            once: true,
            offset: 100
        });

        // DOM Elements
        const loadingOverlay = document.getElementById('loadingOverlay');
        const codeBlock = document.getElementById('codeBlock');
        const copyButton = document.getElementById('copyButton');
        const downloadButton = document.getElementById('downloadButton');
        const scrollToTopBtn = document.getElementById('scrollToTop');
        const progressCircle = document.getElementById('progressCircle');
        const particles = document.getElementById('particles');

        // Loading Screen
        window.addEventListener('load', () => {
            setTimeout(() => {
                loadingOverlay.classList.add('hidden');
            }, 1500);
        });

        // Populate script content
        codeBlock.textContent = scriptContent;

        // Copy functionality with enhanced feedback
        copyButton.addEventListener('click', async () => {
            try {
                await navigator.clipboard.writeText(scriptContent);
                
                // Visual feedback
                const originalText = copyButton.innerHTML;
                const originalClass = copyButton.className;
                
                copyButton.innerHTML = '<i class="fas fa-check"></i> ¡Copiado!';
                copyButton.className = copyButton.className.replace('btn-primary', 'btn-success');
                
                // Add success animation
                copyButton.style.transform = 'scale(1.05)';
                
                setTimeout(() => {
                    copyButton.innerHTML = originalText;
                    copyButton.className = originalClass;
                    copyButton.style.transform = '';
                }, 2000);
                
            } catch (err) {
                console.error('Error copying to clipboard:', err);
                
                // Fallback method
                const textArea = document.createElement('textarea');
                textArea.value = scriptContent;
                textArea.style.position = 'fixed';
                textArea.style.opacity = '0';
                document.body.appendChild(textArea);
                textArea.select();
                
                try {
                    document.execCommand('copy');
                    const originalText = copyButton.innerHTML;
                    copyButton.innerHTML = '<i class="fas fa-check"></i> ¡Copiado!';
                    copyButton.className = copyButton.className.replace('btn-primary', 'btn-success');
                    
                    setTimeout(() => {
                        copyButton.innerHTML = originalText;
                        copyButton.className = copyButton.className.replace('btn-success', 'btn-primary');
                    }, 2000);
                } catch (fallbackErr) {
                    copyButton.innerHTML = '<i class="fas fa-times"></i> Error';
                    copyButton.className = copyButton.className.replace('btn-primary', 'btn-danger');
                    
                    setTimeout(() => {
                        copyButton.innerHTML = '<i class="fas fa-copy"></i> Copiar Script';
                        copyButton.className = copyButton.className.replace('btn-danger', 'btn-primary');
                    }, 2000);
                }
                
                document.body.removeChild(textArea);
            }
        });

        // Download functionality
        downloadButton.addEventListener('click', () => {
            const blob = new Blob([scriptContent], { type: 'text/plain;charset=utf-8' });
            const url = URL.createObjectURL(blob);
            const link = document.createElement('a');
            
            link.href = url;
            link.download = 'OptiClean_Xtreme_v11.ps1';
            link.style.display = 'none';
            
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
            URL.revokeObjectURL(url);
            
            // Visual feedback
            const originalText = downloadButton.innerHTML;
            downloadButton.innerHTML = '<i class="fas fa-check"></i> Descargado!';
            downloadButton.style.transform = 'scale(1.05)';
            
            setTimeout(() => {
                downloadButton.innerHTML = originalText;
                downloadButton.style.transform = '';
            }, 2000);
        });

        // Scroll to top functionality
        scrollToTopBtn.addEventListener('click', (e) => {
            e.preventDefault();
            window.scrollTo({
                top: 0,
                behavior: 'smooth'
            });
        });

        // Progress indicator
        function updateProgressIndicator() {
            const scrollTop = window.pageYOffset;
            const docHeight = document.documentElement.scrollHeight - window.innerHeight;
            const scrollPercent = (scrollTop / docHeight) * 100;
            
            const circumference = 2 * Math.PI * 25;
            const strokeDashoffset = circumference - (scrollPercent / 100) * circumference;
            
            progressCircle.style.strokeDashoffset = strokeDashoffset;
            
            // Show/hide scroll to top button
            if (scrollPercent > 20) {
                scrollToTopBtn.style.opacity = '1';
                scrollToTopBtn.style.transform = 'scale(1)';
            } else {
                scrollToTopBtn.style.opacity = '0';
                scrollToTopBtn.style.transform = 'scale(0.8)';
            }
        }

        // Particle system
        function createParticle() {
            const particle = document.createElement('div');
            particle.className = 'particle';
            
            const startX = Math.random() * window.innerWidth;
            const size = Math.random() * 3 + 1;
            const duration = Math.random() * 15 + 10;
            
            particle.style.left = startX + 'px';
            particle.style.width = size + 'px';
            particle.style.height = size + 'px';
            particle.style.animationDuration = duration + 's';
            particle.style.animationDelay = Math.random() * 2 + 's';
            
            particles.appendChild(particle);
            
            // Remove particle after animation
            setTimeout(() => {
                if (particle.parentNode) {
                    particle.parentNode.removeChild(particle);
                }
            }, (duration + 2) * 1000);
        }

        // Keyboard accessibility
        document.addEventListener('keydown', (e) => {
            if (e.key === 'Escape') {
                // Close any open tooltips or modals
                document.querySelectorAll('.tooltip:hover').forEach(el => {
                    el.blur();
                });
            }
            
            if (e.ctrlKey && e.key === 'c' && document.activeElement === codeBlock) {
                copyButton.click();
            }
        });

        // Intersection Observer for animations
        const observerOptions = {
            threshold: 0.1,
            rootMargin: '0px 0px -50px 0px'
        };

        const observer = new IntersectionObserver((entries) => {
            entries.forEach(entry => {
                if (entry.isIntersecting) {
                    entry.target.style.animationPlayState = 'running';
                }
            });
        }, observerOptions);

        // Observe feature items for staggered animations
        document.querySelectorAll('.feature-item').forEach(item => {
            observer.observe(item);
        });

        // Event listeners
        window.addEventListener('scroll', updateProgressIndicator);
        window.addEventListener('resize', () => {
            // Recreate particles on resize
            particles.innerHTML = '';
            initParticles();
        });

        // Initialize particles
        function initParticles() {
            const particleCount = Math.min(window.innerWidth / 50, 20);
            for (let i = 0; i < particleCount; i++) {
                setTimeout(() => createParticle(), i * 500);
            }
            
            // Continue creating particles
            setInterval(createParticle, 2000);
        }

        // Performance optimization: Reduce particles on mobile
        if (window.innerWidth > 768) {
            initParticles();
        }

        // Initialize progress indicator
        updateProgressIndicator();

        // Add smooth transitions when elements come into view
        const fadeElements = document.querySelectorAll('[data-aos]');
        fadeElements.forEach(el => {
            el.style.transition = 'all 0.6s ease';
        });

        // Console easter egg
        console.log(`
        ╔══════════════════════════════════════════════════════════════╗
        ║                    🚀 OptiClean‑Xtreme v11.0                 ║
        ║                                                              ║
        ║  Página creada con tecnologías web modernas:                ║
        ║  • HTML5 semántico                                          ║
        ║  • CSS Grid & Flexbox                                       ║
        ║  • Animaciones CSS avanzadas                                ║
        ║  • JavaScript ES6+                                          ║
        ║  • Diseño responsivo                                        ║
        ║  • Accesibilidad optimizada                                 ║
        ║  • Efectos visuales modernos                                ║
        ║                                                              ║
        ║  ¡Optimizado para el máximo rendimiento! 🎯                 ║
        ╚══════════════════════════════════════════════════════════════╝
        `);

        // Analytics simulation (replace with real analytics)
        setTimeout(() => {
            console.log('🎯 Página completamente cargada y optimizada');
        }, 2000);

    </script>
</body>
</html>
