<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>OptiClean‑Xtreme v10.0 — Ultra Optimizado (Seguro)</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
  <style>
    body{font-family:'Inter',sans-serif}
    pre::-webkit-scrollbar{width:8px;height:8px}
    pre::-webkit-scrollbar-track{background:#111827}
    pre::-webkit-scrollbar-thumb{background-color:#4b5563;border-radius:20px;border:2px solid #111827}
    code{white-space:pre}
  </style>
</head>
<body class="bg-gray-900 text-gray-200 min-h-screen p-4">
  <div class="max-w-5xl mx-auto">
    <div class="bg-gray-800/70 backdrop-blur rounded-2xl shadow-2xl overflow-hidden ring-1 ring-gray-700">
      <header class="p-6 border-b border-gray-700">
        <h1 class="text-2xl sm:text-3xl font-bold text-white">OptiClean‑Xtreme v10.0</h1>
        <p class="text-gray-400 mt-1">Optimización y reparación <span class="font-semibold">máxima</span> para Windows — Perfil "Turbo Seguro"</p>
        <ul class="mt-3 text-sm text-gray-400 list-disc list-inside space-y-1">
          <li>Más limpieza (estilo CCleaner/BleachBit/ASC) + logs a archivo.</li>
          <li>Debloat seguro ampliado (Xbox/Clipchamp/Cortana/Widgets/Teams/…)</li>
          <li>DISM + SFC + reparación de red + cachés de GPU/Store/Office.</li>
          <li>Privacidad reforzada (telemetría, tareas CEIP, anuncios, consumer features).</li>
          <li>Arranque más rápido (tareas y servicios no críticos) + plan Energía Máximo Rendimiento.</li>
          <li>Modo reversible: crea Punto de Restauración y conserva log.</li>
        </ul>
      </header>

      <section class="relative">
        <pre id="scriptContainer" class="bg-gray-900 p-6 text-xs sm:text-sm text-gray-300 overflow-x-auto max-h-[70vh]"><code class="language-powershell"></code></pre>
        <div class="absolute top-4 right-4 flex gap-2">
          <button id="copyButton" class="bg-indigo-600 hover:bg-indigo-700 text-white font-semibold py-2 px-4 rounded-lg transition-all focus:outline-none focus:ring-2 focus:ring-indigo-500 shadow-lg">Copiar Script</button>
          <button id="downloadButton" class="bg-gray-700 hover:bg-gray-600 text-white font-semibold py-2 px-4 rounded-lg transition-all focus:outline-none focus:ring-2 focus:ring-gray-500 shadow-lg">Descargar .ps1</button>
        </div>
      </section>

      <footer class="p-6 border-t border-gray-700 grid gap-3">
        <h3 class="font-semibold text-lg text-white">Instrucciones</h3>
        <ol class="list-decimal list-inside text-gray-400 space-y-1">
          <li>Hacé clic en <strong>Copiar Script</strong> o <strong>Descargar .ps1</strong>.</li>
          <li>Abrí <strong>PowerShell</strong> (botón derecho &rarr; <strong>Ejecutar como Administrador</strong>).</li>
          <li>Ejecutá el script. Al finalizar, <strong>reiniciá</strong>.</li>
        </ol>
        <p class="text-xs text-gray-500">Nota: Este perfil evita cambios agresivos y no desactiva Windows Update, Defender, ni Búsqueda. Si querés un perfil más extremo, avisanos.</p>
      </footer>
    </div>
  </div>

  <script>
const scriptContent = `#requires -version 5.1
<#
  OptiClean‑Xtreme v10.0 — Perfil "Turbo Seguro"
  Objetivo: acelerar y limpiar al máximo sin romper funciones clave.
  Cambios clave sobre v9:
   - Logs a archivo + resumen al final (tam liberado, advertencias).
   - Limpieza extendida: cachés Office/Edge/Chrome/Firefox/Discord/Teams/Adobe/NVIDIA/AMD/Store/WSA.
   - Debloat ampliado (Xbox/Widgets/Clipchamp/Cortana/Teams/ToDo/… + provisión para nuevos usuarios).
   - Reparación: DISM StartComponentCleanup + ResetBase + RestoreHealth, SFC, WSReset, registro AppX.
   - Privacidad reforzada (telemetría, CEIP, Advertising ID, ConsumerExperience, Feedback, etc.).
   - Optimización: Plan Energía Máximo Rendimiento, animaciones mínimas, TRIM/Defrag seguro, tareas inicio.

  Seguro: crea Punto de Restauración y no toca Defender/Update/Búsqueda/BitLocker.
#>

Set-ExecutionPolicy -ExecutionPolicy Bypass -Scope Process -Force -ErrorAction SilentlyContinue
$ErrorActionPreference = 'SilentlyContinue'

#region Config
$StartTime = Get-Date
$Global:Freed = 0
$Global:Warns = [System.Collections.Generic.List[string]]::new()
$LogPath = Join-Path $env:TEMP ("OptiClean_v10_" + (Get-Date -f 'yyyyMMdd_HHmmss') + ".log")

function Log([string]$msg, [string]$color = 'Gray', [switch]$warn){
  $ts = Get-Date -f 'HH:mm:ss'; $line = "[$ts] $msg"
  Write-Host $line -ForegroundColor $color
  Add-Content -Path $LogPath -Value $line
  if($warn){ $Global:Warns.Add($line) }
}

function Section($title){
  Write-Host "\n"; Write-Host ('-'*88) -ForegroundColor DarkGray
  Log $title 'Magenta'
  Write-Host ('-'*88) -ForegroundColor DarkGray
}

function Require-Admin(){
  $id=[Security.Principal.WindowsIdentity]::GetCurrent();
  $p = New-Object Security.Principal.WindowsPrincipal($id)
  if(-not $p.IsInRole([Security.Principal.WindowsBuiltinRole]::Administrator)){
    throw 'Ejecutá este script como Administrador.'
  }
}

function SizeDeltaTask([scriptblock]$Action){
  $drv = Get-PSDrive $env:SystemDrive.Substring(0,1)
  $before = $drv.Free
  try { & $Action } catch { Log "Error: $($_.Exception.Message)" 'DarkYellow' -warn }
  $after = (Get-PSDrive $drv.Name).Free
  $delta = $after - $before
  if($delta -gt 1MB){ $Global:Freed += $delta; Log ("-> Liberado: {0:N2} MB" -f ($delta/1MB)) 'Green' }
}

function RemoveSafe([string]$path){ if(Test-Path -LiteralPath $path){ try{ Remove-Item -LiteralPath $path -Recurse -Force -ErrorAction Stop } catch{ Log "No se pudo eliminar: $path" 'DarkYellow' -warn } } }

#endregion

#region Preparación
Section '[1] Preparación y Respaldo'
Require-Admin
Log ("Log: $LogPath") 'DarkGray'
try{ Checkpoint-Computer -Description 'OptiClean v10 PRE' -RestorePointType 'MODIFY_SETTINGS' -ErrorAction Stop; Log 'Punto de restauración creado.' 'Green' } catch{ Log 'No se pudo crear el punto de restauración (quizá deshabilitado).' 'DarkYellow' -warn }

# Cerrar procesos típicos para liberar archivos bloqueados
$procs = 'chrome','msedge','firefox','brave','opera','winword','excel','powerpnt','outlook','steam','epicgameslauncher','discord','spotify','teams','zoom','vlc','onedrive','photos','notepad','code'
foreach($p in $procs){ Get-Process $p -ErrorAction SilentlyContinue | Stop-Process -Force -ErrorAction SilentlyContinue }
#endregion

#region Limpieza Extrema (estilo CCleaner/BleachBit)
Section '[2] Limpieza Extrema (cachés y residuos)'

SizeDeltaTask { RemoveSafe "$env:SystemDrive\Windows.old" }

# Temporales de sistema/usuarios
SizeDeltaTask {
  $paths = @("$env:windir\Temp\*","$env:TEMP\*")
  Get-ChildItem "$env:SystemDrive\Users" -Directory -ErrorAction SilentlyContinue | %{
    $paths += (Join-Path $_.FullName 'AppData\\Local\\Temp\\*')
    $paths += (Join-Path $_.FullName 'AppData\\Local\\CrashDumps\\*')
    $paths += (Join-Path $_.FullName 'AppData\\Local\\Microsoft\\Windows\\INetCache\\*')
  }
  $paths | % { RemoveSafe $_ }
}

# Papelera todas las unidades
SizeDeltaTask { Get-PSDrive -PSProvider FileSystem | % { try{ Clear-RecycleBin -DriveLetter $_.Name -Force -ErrorAction Stop } catch{} } }

# Cachés de navegadores (perfiles)
SizeDeltaTask {
  $patterns = @(
   'AppData\\Local\\Microsoft\\Edge\\User Data\\*\\Cache',
   'AppData\\Local\\Microsoft\\Edge\\User Data\\*\\Code Cache',
   'AppData\\Local\\Microsoft\\Edge\\User Data\\*\\GPUCache',
   'AppData\\Local\\Google\\Chrome\\User Data\\*\\Cache',
   'AppData\\Local\\Google\\Chrome\\User Data\\*\\Code Cache',
   'AppData\\Local\\Google\\Chrome\\User Data\\*\\GPUCache',
   'AppData\\Local\\BraveSoftware\\Brave-Browser\\User Data\\*\\Cache',
   'AppData\\Local\\BraveSoftware\\Brave-Browser\\User Data\\*\\Code Cache',
   'AppData\\Local\\BraveSoftware\\Brave-Browser\\User Data\\*\\GPUCache',
   'AppData\\Roaming\\Mozilla\\Firefox\\Profiles\\*\\cache2'
  )
  Get-ChildItem "$env:SystemDrive\Users" -Directory | % { $u=$_.FullName; foreach($pt in $patterns){ Get-ChildItem (Join-Path $u $pt) -Recurse -Force -ErrorAction SilentlyContinue | Remove-Item -Recurse -Force -ErrorAction SilentlyContinue } }
}

# Apps comunes (Office/Discord/Teams/Adobe/Steam/Zoom/NVIDIA/AMD/Store/WSA)
SizeDeltaTask {
  $app = @(
    "$env:APPDATA\\discord\\Cache","$env:APPDATA\\discord\\Code Cache","$env:APPDATA\\discord\\GPUCache",
    "$env:APPDATA\\Microsoft\\Teams\\Cache","$env:APPDATA\\Microsoft\\Teams\\Code Cache","$env:APPDATA\\Microsoft\\Teams\\GPUCache",
    "$env:LOCALAPPDATA\\Spotify\\Browser","$env:LOCALAPPDATA\\EpicGamesLauncher\\Saved\\webcache",
    "$env:ProgramFiles (x86)\\Steam\\appcache","$env:ProgramFiles (x86)\\Steam\\config\\htmlcache",
    "$env:APPDATA\\Zoom\\data\\Cache","$env:APPDATA\\vlc\\art\\cache",
    "$env:LOCALAPPDATA\\Microsoft\\Office\\16.0\\OfficeFileCache","$env:LOCALAPPDATA\\Microsoft\\MSOIdentityCRL",
    "$env:LOCALAPPDATA\\Adobe\\Acrobat\\DC\\Cache","$env:LOCALAPPDATA\\NVIDIA\\DXCache",
    "$env:LOCALAPPDATA\\NVIDIA\\GLCache","$env:ProgramData\\NVIDIA Corporation\\NV_Cache",
    "$env:LOCALAPPDATA\\D3DShaderCache","$env:LOCALAPPDATA\\AMD\\DxCache",
    "$env:LOCALAPPDATA\\Packages\\Microsoft.WindowsStore_8wekyb3d8bbwe\\LocalCache",
    "$env:LOCALAPPDATA\\Packages\\Microsoft.DesktopAppInstaller_8wekyb3d8bbwe\\LocalCache",
    "$env:LOCALAPPDATA\\Packages\\MicrosoftCorporationII.WindowsSubsystemForAndroid_8wekyb3d8bbwe\\LocalCache"
  ); $app | % { RemoveSafe $_ }
}

# Prefetch (reinicia SysMain para evitar errores) — beneficio marginal pero seguro
SizeDeltaTask { Stop-Service SysMain -Force -ErrorAction SilentlyContinue; RemoveSafe "$env:windir\\Prefetch\\*"; Start-Service SysMain -ErrorAction SilentlyContinue }

# Caché de fuentes + thumbs/iconos
SizeDeltaTask {
  Stop-Service FontCache -Force -ErrorAction SilentlyContinue
  Remove-Item "$env:windir\\ServiceProfiles\\LocalService\\AppData\\Local\\FontCache\\*.dat" -Force -ErrorAction SilentlyContinue
  Stop-Process -Name explorer -Force -ErrorAction SilentlyContinue; Start-Sleep 1
  Remove-Item "$env:LOCALAPPDATA\\Microsoft\\Windows\\Explorer\\thumbcache_*.db" -Force -ErrorAction SilentlyContinue
  Remove-Item "$env:LOCALAPPDATA\\IconCache.db" -Force -ErrorAction SilentlyContinue
  Start-Process explorer | Out-Null
}

# Windows Update residuos + Delivery Optimization (seguro)
SizeDeltaTask {
  Stop-Service wuauserv,bits,dosvc -Force -ErrorAction SilentlyContinue
  RemoveSafe "$env:windir\\SoftwareDistribution\\Download\\*"
  RemoveSafe "$env:windir\\DeliveryOptimization\\Cache\\*"
  Start-Service wuauserv,bits,dosvc -ErrorAction SilentlyContinue
}

# WER, dumps, CBS logs (se regeneran solos)
SizeDeltaTask {
  RemoveSafe "$env:windir\\Minidump\\*"
  RemoveSafe "$env:ProgramData\\Microsoft\\Windows\\WER\\*"
  Remove-Item "$env:SystemDrive\\MEMORY.DMP" -Force -ErrorAction SilentlyContinue
  Remove-Item "$env:windir\\Logs\\CBS\\*.log","$env:windir\\Logs\\CBS\\*.cab" -Force -ErrorAction SilentlyContinue
}
#endregion

#region Debloat Seguro
Section '[3] Eliminación de Bloatware (seguro)'

$bloat = @(
 '*3DViewer*','*MixedReality*','*Print3D*','*SkypeApp*','*YourPhone*','*Solitaire*','*Zune*',
 '*BingNews*','*BingWeather*','*GetHelp*','*Getstarted*','*FeedbackHub*','*OfficeHub*','*OneNote*',
 '*People*','*Wallet*','*WindowsAlarms*','*WindowsMaps*','*Messaging*','*SoundRecorder*','*WindowsCamera*',
 '*Clipchamp*','*Cortana*','*MicrosoftTeams*','*PowerAutomate*','*Todos*','*549981C3F5F10*',
 '*Xbox*','*GamingApp*','*Microsoft.GamingApp*','*XboxGameOverlay*','*XboxIdentityProvider*','*XboxSpeechToTextOverlay*',
 '*WebExperience*','*WindowsWidgets*'
)

$all = Get-AppxPackage -AllUsers
$prov = Get-AppxProvisionedPackage -Online
foreach($pat in $bloat){
  $all | ? { $_.Name -like $pat } | % { try{ $_ | Remove-AppxPackage -AllUsers -ErrorAction Stop; Log "Quitado: $($_.Name)" 'DarkGray' } catch{ Log "No se pudo quitar: $($_.Name)" 'DarkYellow' -warn } }
  $prov | ? { $_.DisplayName -like $pat } | % { try{ $_ | Remove-AppxProvisionedPackage -Online -ErrorAction Stop; Log "Quitada provisión: $($_.DisplayName)" 'DarkGray' } catch{ Log "No se pudo quitar provisión: $($_.DisplayName)" 'DarkYellow' -warn } }
}
Log 'Debloat completado.' 'Green'
#endregion

#region Reparación y Salud
Section '[4] Reparaciones (DISM/SFC/Red/Store)'

Log 'DISM StartComponentCleanup + ResetBase (puede tardar)…' 'Cyan'
try{ Dism.exe /Online /Cleanup-Image /StartComponentCleanup /ResetBase | Out-Null; Log 'Completado.' 'Green' } catch{ Log 'Fallo en DISM ResetBase' 'DarkYellow' -warn }

Log 'DISM RestoreHealth…' 'Cyan'
try{ Dism.exe /Online /Cleanup-Image /RestoreHealth | Out-Null; Log 'Completado.' 'Green' } catch{ Log 'Fallo en RestoreHealth' 'DarkYellow' -warn }

Log 'SFC /scannow…' 'Cyan'
try{ sfc.exe /scannow | Out-Null; Log 'SFC completado.' 'Green' } catch{ Log 'Fallo en SFC' 'DarkYellow' -warn }

Log 'Reiniciando pila de red…' 'Cyan'
try{ netsh winsock reset | Out-Null; netsh int ip reset | Out-Null; ipconfig /flushdns | Out-Null; Log 'Red OK.' 'Green' } catch{ Log 'Fallo reseteo de red' 'DarkYellow' -warn }

Log 'WSReset (Tienda Windows)…' 'Cyan'
try{ Start-Process wsreset -Wait -ErrorAction SilentlyContinue; Log 'WSReset ejecutado.' 'Green' } catch{ Log 'WSReset no disponible' 'DarkYellow' -warn }

Log 'Re‑registrando Apps…' 'Cyan'
Get-AppxPackage -AllUsers | ForEach-Object { try{ Add-AppxPackage -DisableDevelopmentMode -Register "$($_.InstallLocation)\\AppXManifest.xml" -ErrorAction Stop } catch{} }
Log 'Re‑registro completado.' 'Green'
#endregion

#region Privacidad Reforzada
Section '[5] Privacidad (telemetría mínima)'

$services = 'DiagTrack','dmwappushservice','diagsvc','PcaSvc','RemoteRegistry'
foreach($s in $services){ if(Get-Service $s -ErrorAction SilentlyContinue){ try{ Set-Service $s -StartupType Disabled; Stop-Service $s -Force -ErrorAction SilentlyContinue } catch{} } }

# Tareas CEIP/Compatibilidad
$tasks = @(
  '\\Microsoft\\Windows\\Application Experience\\Microsoft Compatibility Appraiser',
  '\\Microsoft\\Windows\\Customer Experience Improvement Program\\Consolidator',
  '\\Microsoft\\Windows\\Customer Experience Improvement Program\\UsbCeip',
  '\\Microsoft\\Windows\\Autochk\\Proxy',
  '\\Microsoft\\Windows\\DiskDiagnostic\\Microsoft-Windows-DiskDiagnosticDataCollector'
)
foreach($t in $tasks){ try{ $path=$t.Substring(0,$t.LastIndexOf('\\')); $name=$t.Split('\\')[-1]; Get-ScheduledTask -TaskPath $path -TaskName $name -ErrorAction SilentlyContinue | Disable-ScheduledTask -ErrorAction SilentlyContinue } catch{} }

# Registro privacidad
$reg = @{
  'HKLM:SOFTWARE\\Policies\\Microsoft\\Windows\\DataCollection' = @{AllowTelemetry=0};
  'HKLM:SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\DataCollection' = @{AllowTelemetry=0};
  'HKLM:SYSTEM\\CurrentControlSet\\Control\\WMI\\AutoLogger\\AutoLogger-Diagtrack-Listener' = @{Start=0};
  'HKCU:Software\\Microsoft\\Windows\\CurrentVersion\\AdvertisingInfo' = @{Enabled=0};
  'HKLM:SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer' = @{NoImplicitFeedback=1};
  'HKCU:Software\\Microsoft\\Input\\TIPC' = @{Enabled=0};
  'HKLM:SOFTWARE\\Policies\\Microsoft\\Windows\\CloudContent' = @{DisableWindowsConsumerFeatures=1};
  'HKCU:Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\Advanced' = @{ShowSyncProviderNotifications=0};
  'HKLM:SOFTWARE\\Policies\\Microsoft\\Windows\\Windows Error Reporting' = @{Disabled=1};
  'HKLM:SOFTWARE\\Policies\\MicrosoftEdge\\Main' = @{AllowTelemetry=0}
}
foreach($k in $reg.Keys){ if(-not (Test-Path $k)){ New-Item $k -Force | Out-Null }; foreach($n in $reg[$k].Keys){ try{ New-ItemProperty -Path $k -Name $n -Value $reg[$k][$n] -PropertyType DWord -Force | Out-Null } catch{} } }
Log 'Privacidad aplicada.' 'Green'
#endregion

#region Optimización y Arranque
Section '[6] Optimización (energía/arranque/discos/UI)'

# Energía Máximo Rendimiento
$guid = 'e9a42b02-d5df-448d-aa00-03f14749eb61'
try{ if(-not (powercfg -l | Select-String $guid -Quiet)){ powercfg -duplicatescheme $guid | Out-Null }; powercfg -setactive $guid; Log 'Plan de energía Máximo Rendimiento activo.' 'Green' } catch{ Log 'No se pudo activar el plan de energía.' 'DarkYellow' -warn }

# Hibernación off (libera hiberfil.sys) — seguro en SSD
try{ powercfg -h off } catch{}

# Efectos visuales mínimos (deja ClearType/antialias)
try{ Set-ItemProperty 'HKCU:Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\VisualEffects' -Name VisualFXSetting -Value 2 -Type DWord -Force } catch{}

# SysMain (en SSD suele no aportar)
try{ if(Get-Service SysMain -ErrorAction SilentlyContinue){ Set-Service SysMain -StartupType Disabled; Stop-Service SysMain -Force -ErrorAction SilentlyContinue } } catch{}

# Limpiar entradas Run (solo de apps desinstaladas o rotas)
try{
  $runKeys = 'HKCU:Software\\Microsoft\\Windows\\CurrentVersion\\Run','HKLM:SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run'
  foreach($rk in $runKeys){ if(Test-Path $rk){ Get-ItemProperty $rk | Get-Member -MemberType NoteProperty | %{
    $name=$_.Name; $val = (Get-ItemProperty $rk).$name; if($val -and -not (Test-Path ($val -split '"' | ?{$_} | Select-Object -Last 1))){ try{ Remove-ItemProperty -Path $rk -Name $name -Force } catch{} }
  } } }
} catch{}

# Desactivar algunas tareas de inicio poco útiles
$startupTasks = @(
  '\\Microsoft\\Windows\\ApplicationData\\DsSvcCleanup',
  '\\Microsoft\\Windows\\CloudExperienceHost\\CreateObjectTask',
  '\\Microsoft\\Windows\\Diagnosis\\Scheduled',
  '\\Microsoft\\Windows\\Maps\\MapsToastTask',
  '\\Microsoft\\Windows\\RetailDemo\\Cleanup'
)
foreach($t in $startupTasks){ try{ $path=$t.Substring(0,$t.LastIndexOf('\\')); $name=$t.Split('\\')[-1]; Get-ScheduledTask -TaskPath $path -TaskName $name -ErrorAction SilentlyContinue | Disable-ScheduledTask -ErrorAction SilentlyContinue } catch{} }

# Optimizar discos: TRIM SSD / Defrag HDD
try{ Get-Volume | ? { $_.DriveType -eq 'Fixed' -and $_.HealthStatus -eq 'Healthy' -and $_.DriveLetter } | % { Optimize-Volume -DriveLetter $_.DriveLetter -Defrag -ErrorAction SilentlyContinue } ; Log 'Discos optimizados.' 'Green' } catch{ Log 'Fallo al optimizar discos' 'DarkYellow' -warn }
#endregion

#region Resumen Final
Section '[7] Resumen'
$gb = [math]::Round($Global:Freed/1GB,3)
$mins = [math]::Round((New-TimeSpan -Start $StartTime).TotalMinutes,1)
Log ("Espacio liberado: {0} GB (aprox.)" -f $gb) 'Green'
Log ("Tiempo total: {0} min" -f $mins) 'Green'
if($Global:Warns.Count -gt 0){ Log ("Advertencias: $($Global:Warns.Count). Ver log: $LogPath") 'Yellow' } else { Log 'Sin advertencias registradas.' 'Green' }
Log 'Listo. Recomendado: reiniciar ahora.' 'Cyan'
#endregion
`;

// Pegar contenido al <code>
const codeBlock = document.querySelector('#scriptContainer code');
codeBlock.textContent = scriptContent;

// Copiar al portapapeles
const copyButton = document.getElementById('copyButton');
copyButton.addEventListener('click', () => {
  const ta = document.createElement('textarea');
  ta.value = scriptContent; ta.style.position='fixed'; ta.style.opacity=0; document.body.appendChild(ta);
  ta.select(); document.execCommand('copy'); document.body.removeChild(ta);
  const txt = copyButton.textContent; copyButton.textContent='¡Copiado!';
  copyButton.classList.remove('bg-indigo-600'); copyButton.classList.add('bg-green-600');
  setTimeout(()=>{ copyButton.textContent = txt; copyButton.classList.add('bg-indigo-600'); copyButton.classList.remove('bg-green-600') }, 1800);
});

// Descargar como .ps1
const downloadButton = document.getElementById('downloadButton');
downloadButton.addEventListener('click',()=>{
  const blob = new Blob([scriptContent], {type:'text/plain;charset=utf-8'});
  const url = URL.createObjectURL(blob);
  const a = document.createElement('a');
  a.href = url; a.download = 'OptiClean_Xtreme_v10.ps1'; a.click();
  URL.revokeObjectURL(url);
});
  </script>
</body>
</html>
