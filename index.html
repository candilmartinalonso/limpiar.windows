<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Optimizador Tit√°n para Windows - Script PowerShell</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;900&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #0a0e1a;
        }
        .glass-effect {
            background: rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        .code-block::-webkit-scrollbar {
            width: 8px;
            height: 8px;
        }
        .code-block::-webkit-scrollbar-thumb {
            background: #4a5568;
            border-radius: 4px;
        }
        .code-block::-webkit-scrollbar-track {
            background: rgba(255, 255, 255, 0.1);
        }
        .btn-glow:hover {
            box-shadow: 0 0 15px 2px rgba(52, 211, 153, 0.6);
        }
    </style>
</head>
<body class="text-gray-200">
    <div class="min-h-screen bg-cover bg-center bg-fixed" style="background-image: url('https://placehold.co/1920x1080/0a0e1a/34d399?text=.')">
        <div class="container mx-auto px-4 py-8 md:py-16">

            <!-- Encabezado -->
            <header class="text-center mb-12">
                <h1 class="text-4xl md:text-6xl font-black text-white tracking-tighter mb-4">
                    Optimizador Tit√°n para Windows
                </h1>
                <p class="text-lg md:text-xl text-emerald-300 max-w-3xl mx-auto">
                    El script de PowerShell definitivo para limpiar, actualizar y acelerar tu PC a un nivel superior.
                </p>
            </header>

            <!-- Secci√≥n del Script -->
            <main>
                <div class="glass-effect rounded-2xl p-6 md:p-8 max-w-5xl mx-auto">
                    <div class="flex justify-between items-center mb-4">
                        <h2 class="text-2xl font-bold text-white">Script de PowerShell v3.0</h2>
                        <button id="copyButton" class="bg-emerald-500 text-gray-900 font-bold py-2 px-5 rounded-lg transition-all duration-300 btn-glow hover:bg-emerald-400 focus:outline-none focus:ring-2 focus:ring-emerald-300">
                            Copiar Script
                        </button>
                    </div>

                    <!-- Bloque de C√≥digo -->
                    <div class="bg-gray-900/70 rounded-lg overflow-hidden">
                        <pre class="code-block language-powershell p-4 text-sm overflow-x-auto h-96"><code id="powerShellScript">
# =================================================================================================
#
#   PowerScript Optimizer TITAN v3.0
#   Limpia, actualiza y optimiza Windows para un rendimiento TIT√ÅNICO.
#   ADVERTENCIA: Ejecutar siempre como Administrador. √ösese bajo su propia responsabilidad.
#
# =================================================================================================

#region Pre-Execution Checks, Functions and Setup
# --- VERIFICACI√ìN DE PERMISOS DE ADMINISTRADOR ---
if (-NOT ([Security.Principal.WindowsPrincipal][Security.Principal.WindowsIdentity]::GetCurrent()).IsInRole([Security.Principal.WindowsBuiltInRole]::Administrator)) {
    Write-Warning "Este script requiere privilegios de Administrador. Por favor, abre PowerShell como Administrador."
    Start-Sleep -Seconds 10
    Exit
}

# --- FUNCI√ìN PARA MOSTRAR T√çTULOS DE SECCI√ìN ---
function Show-SectionTitle {
    param([string]$Title)
    Write-Host "`n"; Write-Host "================================================================" -ForegroundColor Cyan
    Write-Host "    $Title" -ForegroundColor White
    Write-Host "================================================================" -ForegroundColor Cyan
}

# --- CONFIRMACI√ìN DEL USUARIO ---
Clear-Host
Write-Host "üöÄ INICIANDO OPTIMIZADOR TITAN PARA WINDOWS üöÄ" -ForegroundColor Green
Write-Host "Este script realizar√° una limpieza profunda, actualizar√° Windows y todas tus aplicaciones, y aplicar√° optimizaciones avanzadas." -ForegroundColor Yellow
Write-Host "ADVERTENCIA: Se recomienda cerrar todos los programas antes de continuar." -ForegroundColor Red
$confirmation = Read-Host "¬øEst√°s seguro de que deseas continuar? (S/N)"
if ($confirmation -ne 'S' -and $confirmation -ne 's') {
    Write-Host "Operaci√≥n cancelada por el usuario." -ForegroundColor Red; Start-Sleep -Seconds 5; Exit
}
#endregion

#region System Restore
# --- CREACI√ìN DE PUNTO DE RESTAURACI√ìN (CR√çTICO) ---
Show-SectionTitle "Creando Punto de Restauraci√≥n del Sistema"
$restorePoint = Get-ComputerRestorePoint -ErrorAction SilentlyContinue | Where-Object { $_.CreationTime -gt (Get-Date).AddHours(-1) }
if ($restorePoint) {
    Write-Host "‚úÖ Ya existe un punto de restauraci√≥n reciente. Omitiendo creaci√≥n." -ForegroundColor Green
} else {
    Write-Host "‚öôÔ∏è Creando punto de restauraci√≥n... (puede tardar unos minutos)" -ForegroundColor Yellow
    Checkpoint-Computer -Description "Pre-Optimizador-Titan" -RestorePointType "MODIFY_SETTINGS"
    Write-Host "‚úÖ Punto de restauraci√≥n 'Pre-Optimizador-Titan' creado." -ForegroundColor Green
}
#endregion

#region Software and OS Updates
# --- FASE 1: ACTUALIZACI√ìN DEL SISTEMA Y APLICACIONES ---
Show-SectionTitle "Fase 1: Actualizaci√≥n del Sistema y Aplicaciones"

# --- WINDOWS UPDATE ---
Write-Host "üîÑ Buscando e instalando actualizaciones de Windows..." -ForegroundColor White
Write-Host "Este proceso puede tardar MUCHO tiempo. Ten paciencia." -ForegroundColor Yellow
Install-PackageProvider -Name NuGet -MinimumVersion 2.8.5.201 -Force -ErrorAction SilentlyContinue
Install-Module -Name PSWindowsUpdate -Force -AcceptLicense -ErrorAction SilentlyContinue
Import-Module PSWindowsUpdate -ErrorAction SilentlyContinue
Get-WindowsUpdate -AcceptAll -Install -AutoReboot | Out-Null
Write-Host "‚úÖ Sistema operativo Windows actualizado." -ForegroundColor Green

# --- WINGET APP UPDATES ---
Write-Host "üì¶ Actualizando todas las aplicaciones con Winget..." -ForegroundColor White
$wingetPath = "$env:LOCALAPPDATA\Microsoft\WindowsApps\winget.exe"
if (Test-Path $wingetPath) {
    Write-Host "   - Winget detectado. Actualizando todos los paquetes..." -ForegroundColor Gray
    winget upgrade --all --accept-package-agreements --accept-source-agreements --disable-interactivity
    Write-Host "‚úÖ Aplicaciones actualizadas a su √∫ltima versi√≥n." -ForegroundColor Green
} else {
    Write-Warning "Winget no se encontr√≥. No se pueden actualizar las aplicaciones. Inst√°lalo desde la Microsoft Store ('Instalador de aplicaci√≥n')."
}
#endregion

#region Aggressive Deep Cleaning
# --- FASE 2: LIMPIEZA AGRESIVA DEL SISTEMA ---
Show-SectionTitle "Fase 2: Limpieza Agresiva del Sistema"
$initialDiskSpace = (Get-PSDrive C).Free

# --- LIMPIEZA DEL COMPONENT STORE (WINSXS) ---
Write-Host "üßπ Limpiando el almac√©n de componentes de Windows (WinSxS)..." -ForegroundColor White
Dism.exe /online /Cleanup-Image /StartComponentCleanup | Out-Null
Write-Host "‚úÖ Almac√©n de componentes optimizado." -ForegroundColor Green

# --- LIMPIEZA DE ARCHIVOS EST√ÅNDAR Y CACH√âS ---
$locationsToClean = @(
    "$env:TEMP\*", "$env:SystemRoot\Temp\*", "$env:SystemRoot\SoftwareDistribution\Download\*",
    "$env:windir\Prefetch\*", "$env:LOCALAPPDATA\Microsoft\Windows\Explorer\thumbcache_*.db",
    "$env:LOCALAPPDATA\Microsoft\Edge\User Data\Default\Cache\*", 
    "$env:LOCALAPPDATA\Google\Chrome\User Data\Default\Cache\*",
    "$env:LOCALAPPDATA\Mozilla\Firefox\Profiles\*\cache2\entries\*"
)
foreach ($location in $locationsToClean) {
    Write-Host "üßπ Limpiando: $location" -ForegroundColor Gray
    Remove-Item -Path $location -Recurse -Force -ErrorAction SilentlyContinue
}
Clear-RecycleBin -Force -ErrorAction SilentlyContinue; ipconfig /flushdns
$regKey = "HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\VolumeCaches"
Get-ChildItem -Path $regKey | ForEach-Object {Set-ItemProperty -Path $_.PSPath -Name "StateFlags0001" -Value 2 -Type DWord -Force -ErrorAction SilentlyContinue}
cleanmgr.exe /sagerun:1 | Out-Null
$finalDiskSpace = (Get-PSDrive C).Free; $spaceFreed = [math]::Round(($finalDiskSpace - $initialDiskSpace) / 1GB, 2)
#endregion

#region Advanced Performance Tweaks
# --- FASE 3: OPTIMIZACIONES DE RENDIMIENTO AVANZADAS ---
Show-SectionTitle "Fase 3: Optimizaciones de Rendimiento Avanzadas"

# --- PLAN DE ENERG√çA DE M√ÅXIMO RENDIMIENTO ---
powercfg -duplicatescheme e9a42b02-d5df-448d-aa00-03f14749eb61 | Out-Null
$planGuid = (powercfg -l | Select-String "M√°ximo rendimiento" -split " ")[3]
powercfg /s $planGuid
Write-Host "‚ö° Plan de energ√≠a 'M√°ximo Rendimiento' activado." -ForegroundColor Green

# --- AJUSTES GENERALES DE RENDIMIENTO ---
powercfg.exe /hibernate off
Set-ItemProperty -Path "HKCU:\Software\Microsoft\Windows\CurrentVersion\Explorer\VisualEffects" -Name "VisualFxSetting" -Value 2
Write-Host "üé® Hibernaci√≥n desactivada y efectos visuales optimizados." -ForegroundColor Green

# --- AJUSTES DE REGISTRO PARA MAYOR RESPUESTA ---
Set-ItemProperty -Path "HKCU:\Control Panel\Desktop" -Name "MenuShowDelay" -Value "200"
Set-ItemProperty -Path "HKCU:\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced" -Name "NoNetCrawling" -Value "1" -Type DWord
Write-Host "‚öôÔ∏è Ajustes de registro para respuesta de UI aplicados." -ForegroundColor Green

# --- DESACTIVAR SERVICIOS Y TAREAS INNECESARIAS ---
$servicesToDisable = @("DiagTrack", "dmwappushservice", "SysMain")
$tasksToDisable = @("\Microsoft\Windows\Application Experience\Microsoft Compatibility Appraiser", "\Microsoft\Windows\Customer Experience Improvement Program\Consolidator")
foreach ($service in $servicesToDisable) {Set-Service -Name $service -StartupType Disabled -Status Stopped -ErrorAction SilentlyContinue}
foreach ($task in $tasksToDisable) {Disable-ScheduledTask -TaskPath $task -ErrorAction SilentlyContinue}
Write-Host "üîß Servicios y tareas de telemetr√≠a desactivados." -ForegroundColor Green

# --- OPTIMIZACIONES DE RED AVANZADAS ---
netsh int tcp set global autotuninglevel=normal; netsh int tcp set global ecncapability=enabled
netsh int tcp set global rss=enabled; netsh int tcp set supplemental template=internet congestionprovider=cubic
Write-Host "üåê Optimizaciones de red aplicadas." -ForegroundColor Green

# --- LISTAR PROGRAMAS DE INICIO ---
Write-Host "üîç Listando programas que se inician con Windows (para revisi√≥n manual):" -ForegroundColor Yellow
Get-CimInstance Win32_StartupCommand | Select-Object Name, User, Location | Format-Table -AutoSize
#endregion

#region System Maintenance
# --- FASE 4: MANTENIMIENTO DEL SISTEMA ---
Show-SectionTitle "Fase 4: Mantenimiento del Sistema"
Write-Host "üíΩ Optimizando unidades (TRIM/Defrag)..." -ForegroundColor White
Get-WmiObject -Class Win32_Volume | Where-Object { $_.DriveType -eq 3 -and $_.DriveLetter } | ForEach-Object { Optimize-Volume -DriveLetter $_.DriveLetter.Substring(0,1) -Verbose }
Write-Host "üîé Verificando integridad de archivos del sistema (SFC /scannow)..." -ForegroundColor White
sfc.exe /scannow | Out-Null
Write-Host "‚úÖ Mantenimiento del sistema completado." -ForegroundColor Green
#endregion

#region Finalization and Report
# --- FINALIZACI√ìN Y REPORTE ---
Show-SectionTitle "Optimizaci√≥n Tit√°nica Completada"
Write-Host "üéâ ¬°Tu PC ha sido optimizado exitosamente!" -ForegroundColor Green
Write-Host "--- RESUMEN DE LA OPERACI√ìN ---" -ForegroundColor Cyan
Write-Host "   - Espacio en disco liberado: $spaceFreed GB" -ForegroundColor White
Write-Host "   - Sistema Operativo y Aplicaciones: Actualizados." -ForegroundColor White
Write-Host "   - Rendimiento: M√∫ltiples ajustes aplicados para m√°xima velocidad." -ForegroundColor White
Write-Host "`nSe recomienda ENCARECIDAMENTE reiniciar el sistema ahora." -ForegroundColor Yellow
Write-Host "El script se cerrar√° en 20 segundos." -ForegroundColor Gray
Start-Sleep -Seconds 20
#endregion
</code></pre>
                    </div>

                    <div id="copy-feedback" class="text-center text-emerald-400 font-semibold mt-4 h-6 transition-opacity duration-300 opacity-0">
                        ¬°Script copiado al portapapeles!
                    </div>

                    <!-- Instrucciones -->
                    <div class="mt-8">
                        <h3 class="text-xl font-bold text-white mb-3">Instrucciones de Uso</h3>
                        <ol class="list-decimal list-inside space-y-3 text-gray-300">
                             <li>Haz clic derecho en el men√∫ de Inicio y selecciona <span class="font-semibold text-emerald-300 bg-gray-800/50 px-2 py-1 rounded-md">PowerShell (Administrador)</span>.</li>
                            <li>Copia el script con el bot√≥n de arriba y p√©galo en PowerShell (clic derecho).</li>
                            <li>Escribe <span class="font-semibold text-emerald-300">"S"</span> y presiona <span class="font-semibold text-emerald-300">Enter</span> para confirmar.</li>
                            <li>El proceso tardar√° bastante. Al finalizar, reinicia tu PC.</li>
                        </ol>
                    </div>
                </div>
            </main>

             <!-- Secci√≥n de Caracter√≠sticas -->
            <section class="max-w-5xl mx-auto mt-16 text-center">
                 <h2 class="text-3xl font-bold text-white mb-8">¬øQu√© hace este script?</h2>
                 <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6">
                    <div class="glass-effect rounded-xl p-6">
                        <div class="text-4xl mb-3">üîÑ</div>
                        <h4 class="font-bold text-lg text-white">Actualizaci√≥n Total</h4>
                        <p class="text-gray-400 text-sm">Instala las √∫ltimas actualizaciones de Windows y de todos tus programas instalados v√≠a Winget.</p>
                    </div>
                    <div class="glass-effect rounded-xl p-6">
                        <div class="text-4xl mb-3">üßπ</div>
                        <h4 class="font-bold text-lg text-white">Limpieza Agresiva</h4>
                        <p class="text-gray-400 text-sm">Limpia el almac√©n WinSxS, cach√©s de navegadores, archivos temporales y basura del sistema.</p>
                    </div>
                    <div class="glass-effect rounded-xl p-6">
                        <div class="text-4xl mb-3">‚ö°</div>
                        <h4 class="font-bold text-lg text-white">Optimizaci√≥n Extrema</h4>
                        <p class="text-gray-400 text-sm">Aplica ajustes de registro y red, desactiva telemetr√≠a y activa el plan de m√°ximo rendimiento.</p>
                    </div>
                    <div class="glass-effect rounded-xl p-6">
                        <div class="text-4xl mb-3">üõ°Ô∏è</div>
                        <h4 class="font-bold text-lg text-white">Seguro y Fiable</h4>
                        <p class="text-gray-400 text-sm">Crea un punto de restauraci√≥n antes de empezar y utiliza comandos seguros y probados de Windows.</p>
                    </div>
                 </div>
            </section>

            <!-- Footer -->
            <footer class="text-center mt-16 py-6 border-t border-white/10">
                <p class="text-gray-400">Desarrollado con ‚ù§Ô∏è para la comunidad de Windows.</p>
                 <p class="text-gray-500 text-sm">√ösese de forma responsable. No nos hacemos cargo de posibles problemas.</p>
            </footer>
        </div>
    </div>

    <script>
        const copyButton = document.getElementById('copyButton');
        const powerShellScript = document.getElementById('powerShellScript').textContent;
        const copyFeedback = document.getElementById('copy-feedback');

        copyButton.addEventListener('click', () => {
            navigator.clipboard.writeText(powerShellScript.trim()).then(() => {
                copyFeedback.classList.remove('opacity-0');
                copyButton.textContent = '¬°Copiado!';
                copyButton.classList.add('bg-green-600');
                setTimeout(() => {
                    copyFeedback.classList.add('opacity-0');
                    copyButton.textContent = 'Copiar Script';
                    copyButton.classList.remove('bg-green-600');
                }, 2000);
            }).catch(err => {
                try {
                    const textArea = document.createElement('textarea');
                    textArea.value = powerShellScript.trim();
                    document.body.appendChild(textArea);
                    textArea.select();
                    document.execCommand('copy');
                    document.body.removeChild(textArea);
                    copyFeedback.classList.remove('opacity-0');
                    copyButton.textContent = '¬°Copiado!';
                    copyButton.classList.add('bg-green-600');
                     setTimeout(() => {
                        copyFeedback.classList.add('opacity-0');
                        copyButton.textContent = 'Copiar Script';
                        copyButton.classList.remove('bg-green-600');
                    }, 2000);
                } catch (error) {
                    copyFeedback.textContent = 'Error al copiar.';
                    copyFeedback.classList.add('text-red-500');
                }
            });
        });
    </script>
</body>
</html>

