<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Optimizador Singularidad (El Final del Juego) para Windows</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Fira+Code&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background: #0c0a09 url('https://www.transparenttextures.com/patterns/subtle-prism.png');
        }
Ctrl+A            background-color: rgba(23, 21, 53, 0.8); 
            backdrop-filter: blur(10px);
            color: #e0e7ff; /* indigo-100 */
            border: 1px solid #4c1d95; /* violet-800 */
            border-radius: 0.5rem;
            padding: 1.25rem;
            position: relative;
            font-family: 'Fira Code', monospace;
            white-space: pre-wrap;
            word-wrap: break-word;
            font-size: 0.9rem;
            line-height: 1.6;
        }
  Ctrl+A     if ((Read-Host "`n`n¿Deseas eliminar TODOS los Puntos de Restauración? (IRREVERSIBLE) [s/n]") -eq 's') {
        Write-Host " - Eliminando puntos de restauración..." -ForegroundColor Red
        try { vssadmin delete shadows /all /quiet } catch { Write-Host "   No se pudieron eliminar." -ForegroundColor Yellow }
    }
    Clear-RecycleBin -Force -ErrorAction SilentlyContinue; ipconfig /flushdns
}

# --- PASO 2: SINGULARIDAD DE MEMORIA (PURGA DE RAM) ---
Function Step2-Memory-Singularity {
    # ... (código sin cambios)
    Write-Host "`n[PASO 2 de 11] - Purgando la Memoria RAM en caché (Standby List)..." -ForegroundColor Green
    try {
        $Signature = '[DllImport("ntdll.dll")] public static extern int NtSetSystemInformation(int SystemInformationClass, IntPtr SystemInformation, int SystemInformationLength);'
        $Kernel32 = Add-Type -MemberDefinition $Signature -Name 'Kernel32' -Namespace 'Win32' -PassThru
        $SystemInfo = New-Object IntPtr -ArgumentList 0
        $Kernel32::NtSetSystemInformation(80, $SystemInfo, 0) | Out-Null
        Write-Host "   Memoria en Standby liberada con éxito." -ForegroundColor White
    } catch { Write-Host "   No se pudo purgar la memoria." -ForegroundColor Yellow }
}

# --- PASO 3: INTEGRIDAD DEL NÚCLEO ---
Function Step3-Core-Integrity {
    Write-Host "`n[PASO 3 de 11] - Verificando y reparando la integridad del núcleo..." -ForegroundColor Green
    sfc /scannow
    DISM /Online /Cleanup-Image /RestoreHealth
}

# --- PASO 4: ACTUALIZADOR TAQUIÓNICO ---
Function Step4-Tachyon-Updater {
    Write-Host "`n[PASO 4 de 11] - Iniciando Actualizador Taquiónico..." -ForegroundColor Green
    Write-Host " - Buscando actualizaciones de Windows..."
    try { UsoClient.exe StartInteractiveScan } catch { Write-Host "   Fallo al iniciar UsoClient.exe." -ForegroundColor Yellow }
    
    Write-Host "`n - Buscando actualizaciones para programas con Winget..." -ForegroundColor White
    Read-Host "Presiona ENTER para comenzar la actualización de programas..."
    try { winget upgrade --all --accept-source-agreements --accept-package-agreements } 
    catch { Write-Host "   Winget falló o no está instalado." -ForegroundColor Red }
}

# --- PASO 5: AJUSTES DE REGISTRO: UI CÓSMICA ---
Function Step5-Registry-Cosmic-UI {
    Write-Host "`n[PASO 5 de 11] - Aplicando ajustes de registro para una UI Cósmica..." -ForegroundColor Green
    Set-ItemProperty -Path "HKCU:\Control Panel\Desktop" -Name "MenuShowDelay" -Value "0"
    Set-ItemProperty -Path "HKCU:\Control Panel\Desktop" -Name "WaitToKillAppTimeout" -Value "2000"
}

# --- PASO 6: AJUSTES DE REGISTRO: RENDIMIENTO ABSOLUTO ---
Function Step6-Registry-Absolute-Performance {
    Write-Host "`n[PASO 6 de 11] - Aplicando ajustes de registro para Rendimiento Absoluto..." -ForegroundColor Green
    Write-Host " - Aniquilando Power Throttling..."
    $PwrPath = "HKLM:\SYSTEM\CurrentControlSet\Control\Power\PowerThrottling"
    if (-not (Test-Path $PwrPath)) { New-Item -Path $PwrPath -Force | Out-Null }
    Set-ItemProperty -Path $PwrPath -Name "PowerThrottlingOff" -Value 1 -Type DWord -Force
    Write-Host " - Desbloqueando núcleos de arranque..."
    $BcdPath = bcdedit /enum "{current}"
    if ($BcdPath -notlike "*numproc*") { bcdedit /set "{current}" numproc $env:NUMBER_OF_PROCESSORS }
    Write-Host " - Desactivando Network Throttling..."
    $NetPath = "HKLM:\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Multimedia\SystemProfile"
    if (-not (Test-Path $NetPath)) { New-Item -Path $NetPath -Force | Out-Null }
    Set-ItemProperty -Path $NetPath -Name "NetworkThrottlingIndex" -Value 0xffffffff -Type DWord -Force
}

# --- PASO 7: OPTIMIZACIÓN SSD: ESTADO SÓLIDO ---
Function Step7-Solid-State-Optimization {
    Write-Host "`n[PASO 7 de 11] - Aplicando optimizaciones para SSD..." -ForegroundColor Green
    Optimize-Volume -DriveLetter $env:SystemDrive.Substring(0,1) -ReTrim -Verbose
    powercfg /hibernate off
    Stop-Service -Name "SysMain" -Force -ErrorAction SilentlyContinue; Set-Service -Name "SysMain" -StartupType Disabled
}

# --- PASO 8: PRIVACIDAD INQUEBRANTABLE ---
Function Step8-Unbreakable-Privacy {
    Write-Host "`n[PASO 8 de 11] - Aplicando mejoras de Privacidad Inquebrantable..." -ForegroundColor Green
    Stop-Service DiagTrack; Set-Service DiagTrack -StartupType Disabled
    $TelemetryPath = "HKLM:\SOFTWARE\Policies\Microsoft\Windows\DataCollection"
    if (-not (Test-Path $TelemetryPath)) { New-Item -Path $TelemetryPath -Force | Out-Null }
    Set-ItemProperty -Path $TelemetryPath -Name "AllowTelemetry" -Value 0 -Type DWord -Force
    $Tasks = @('\Microsoft\Windows\Customer Experience Improvement Program\Consolidator', '\Microsoft\Windows\Application Experience\Microsoft Compatibility Appraiser')
    foreach($Task in $Tasks){ Get-ScheduledTask -TaskName $Task -ErrorAction SilentlyContinue | Disable-ScheduledTask }
}

# --- PASO 9: TUNING DE SERVICIOS DEFINITIVO (INTERACTIVO) ---
Function Step9-Ultimate-Service-Tuning {
    Write-Host "`n[PASO 9 de 11] - Tuning de Servicios Definitivo..." -ForegroundColor Green
    Function Disable-Service($ServiceName, $DisplayName) {
        Write-Host " - Desactivando servicio '$DisplayName'..."
        Stop-Service -Name $ServiceName -Force -ErrorAction SilentlyContinue
        Set-Service -Name $ServiceName -StartupType Disabled -ErrorAction SilentlyContinue
    }
    
    if ((Read-Host "¿Usas la BÚSQUEDA DE WINDOWS (barra de búsqueda) intensivamente? (Responder 'n' da una ganancia MASIVA de rendimiento) [s/n]") -eq 'n') { Disable-Service 'WSearch' 'Windows Search' }
    if ((Read-Host "¿Usas una IMPRESORA física? [s/n]") -eq 'n') { Disable-Service 'Spooler' 'Cola de Impresión' }
    if ((Read-Host "¿Usas dispositivos BLUETOOTH? [s/n]") -eq 'n') { Disable-Service 'bthserv' 'Servicio de compatibilidad con Bluetooth' }
    if ((Read-Host "¿Usas aplicaciones que necesiten tu UBICACIÓN (Mapas, Tiempo, etc.)? [s/n]") -eq 'n') { Disable-Service 'lfsvc' 'Servicio de Geolocalización' }
    if ((Read-Host "¿Usas ESCRITORIO REMOTO para conectarte a este equipo? [s/n]") -eq 'n') { Disable-Service 'TermService' 'Servicios de Escritorio Remoto' }
}

# --- PASO 10: CONTROL DE INICIO Y DEBLOAT ---
Function Step10-Launch-Control-Debloat {
    Write-Host "`n[PASO 10 de 11] - Asistente de Control de Inicio y Debloat..." -ForegroundColor Green
    Read-Host "Presiona ENTER para abrir 'Aplicaciones de arranque' y DESHABILITA lo que no necesites..."
    Start-Process "ms-settings:startupapps"
    Read-Host "Presiona ENTER para abrir 'Desinstalar un programa' y ELIMINA lo que no uses..."
    control.exe appwiz.cpl
}

# --- PASO 11: FINALIZACIÓN (HORIZONTE DE SUCESOS) ---
Function Step11-Event-Horizon {
    Write-Host "`n`n[PROCESO FINALIZADO] - Cruzando el Horizonte de Sucesos..." -ForegroundColor Green
    Stop-Process -Name explorer -Force
    Write-Host "`n`n=======================================================" -ForegroundColor 'DarkMagenta'
    Write-Host "¡OPTIMIZACIÓN SINGULARIDAD COMPLETADA!" -ForegroundColor 'DarkMagenta'
    Write-Host "El rendimiento ha alcanzado su forma final. El reinicio es absoluto." -ForegroundColor White
    Write-Host "REINICIA TU EQUIPO AHORA. Bienvenido al otro lado." -ForegroundColor Yellow
    Write-Host "======================================================="
}

# --- EJECUCIÓN DEL SCRIPT ---
Show-Intro
Step1-The-Great-Purge
Step2-Memory-Singularity
Step3-Core-Integrity
Step4-Tachyon-Updater
Step5-Registry-Cosmic-UI
Step6-Registry-Absolute-Performance
Step7-Solid-State-Optimization
Step8-Unbreakable-Privacy
Step9-Ultimate-Service-Tuning
Step10-Launch-Control-Debloat
Step11-Event-Horizon

                    </code></pre>
                </div>
            </div>
        </main>
        
        <footer class="text-center text-slate-500 mt-12">
            <p>&copy; 2024. El juego ha terminado. Has ganado.</p>
        </footer>
    </div>

    <script>
        document.getElementById('copyButton').addEventListener('click', function() {
            const scriptText = document.getElementById('powerShellScript').textContent;
            const textArea = document.createElement('textarea');
            textArea.value = scriptText;
            document.body.appendChild(textArea);
            textArea.select();
            try {
                document.execCommand('copy');
                this.textContent = '¡Copiado!';
                this.style.backgroundColor = '#10B981';
                this.style.color = '#fff';
            } catch (err) {
                this.textContent = 'Error';
                this.style.backgroundColor = '#EF4444';
                console.error('No se pudo copiar el texto: ', err);
            }
            document.body.removeChild(textArea);
            
            setTimeout(() => {
                this.textContent = 'Copiar Script Singularidad';
                this.style.backgroundColor = '#3730a3';
                this.style.color = '#e0e7ff';
            }, 3000);
        });
    </script>
</body>
</html>

